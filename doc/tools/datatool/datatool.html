<!--#set var="TITLE" value="DATATOOL -- the data serialization utility (NCBI C++)" -->
<!--#set var="DOCROOT" value="../.." -->
<!--#include virtual="../../ssi/header.shtml" -->

<h1>DATATOOL - the data serialization utility (NCBI C++)</h1>

<ul>
<li>
<a href="#refSynopsis">Synopsis</a></li>

<li>
<a href="#refArgs">Invocation</a></li>

<ul>
<li>
<a href="#refMainArgs">Main arguments</a></li>

<li>
<a href="#refCodeGenerationArgs">Code generation arguments</a></li>
</ul>

<li>
<a href="#refDefFile">Definition file</a></li>

<ul>
<li>
<a href="#refDefCommon">Common definitions</a></li>

<li>
<a href="#refDefINT">INTEGER, REAL, BOOLEAN, NULL</a></li>

<li>
<a href="#refDefENUM">ENUMERATED</a></li>

<li>
<a href="#refDefOCTETS">OCTET STRING</a></li>

<li>
<a href="#refDefArray">SEQUENCE OF, SET OF</a></li>

<li>
<a href="#refDefClass">SEQUENCE, SET</a></li>

<li>
<a href="#refDefChoice">CHOICE</a></li>
</ul>

<li>
<a href="#refCode">Generated code</a></li>

<ul>
<li>
<a href="#refNormalizedName">Normalized name</a></li>

<li>
<a href="#refCodeEnum">ENUMERATED</a></li>

<li>
<a href="#refCodeClass">SEQUENCE, SET</a></li>

<li>
<a href="#refCodeChoice">CHOICE</a></li>

<li>
<a href="#refCodeOther">Other</a></li>
</ul>
</ul>


<h2><a NAME="refSynopsis"></a><a NAME="refArgs"></a>Synopsis</h2>

<table border cellspacing=0>
<tr VALIGN=BASELINE>
<th ALIGN=RIGHTE>Location:</th>

<td><span class="ncbi_dir">c++/src/serial/datatool</span></td>
</tr>

<tr VALIGN=BASELINE>
<th ALIGN=RIGHT>Synopsis:</th>

<td>
  <ol>
    <li>read ASN.1 data specifications</li>
    <li>read/write ASN.1 or XML data</li>
    <li>write ASN.1 or DTD data specification</li>
    <li>generate C++ classes to serialize (read/write) the data</li>
  </ol>
</td>
</tr>
</table>

<p>This program is intended for data conversion between ASN.1 and XML and
for generation of C++ class hierarchy based on ASN.1 data definition.


<h2><a NAME="refArgs"></a>Invocation</h2>

<h3>
<a NAME="refMainArgs"></a>Main arguments</h3>
Equivalent to arguments of asntool

<table border cellspacing=0>

<tr>
<th>argument</th>
<th>effect</th>
<th>comment</th>
</tr>

<tr>
<td><span class="ncbi_app_a">-h</span></td>
<td>display DATATOOL arguments</a></td>
<td>&nbsp;</td>
</tr>

<tr VALIGN=BASELINE>
<td><a NAME="refArg_m"></a><span class="ncbi_app_a">-m &lt;file&gt;</span></td>
<td>ASN.1 module file(s)</td>
<td>required argument</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-M &lt;file&gt;</span></td>
<td>external module file(s)</td>
<td ROWSPAN="2">is used for IMPORT type resolution</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-i</span></td>
<td>ignore unresolved types</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-f &lt;file&gt;</span></td>
<td>write ASN.1 module file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-fx &lt;file&gt;</span></td>
<td>write DTD module file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-dn &lt;string&gt;</span></td>
<td>DTD module name in XML header</td>
<td>no extension</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-v &lt;file&gt;</span></td>
<td>read value in ASN.1 text format</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-vx &lt;file&gt;</span></td>
<td>read value in XML format</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-F</span></td>
<td>read value completely into memory</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-p &lt;file&gt;</span></td>
<td>write value in ASN.1 text format</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-px &lt;file&gt;</span></td>
<td>write value in XML format</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-d &lt;file&gt;<</span>/td>
<td>read value in ASN.1 binary format</td>
<td><a href="#refArg_t"><span class="ncbi_app_a">-t</span></a> argument required</td>
</tr>

<tr VALIGN=BASELINE>
<td><a NAME="refArg_t"></a><span class="ncbi_app_a">-t &lt;type&gt;</span></td>
<td>binary value type</td>
<td>see <span class="ncbi_app_a">-d</span> argument</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-e &lt;file&gt;</span></td>
<td>write value in ASN.1 binary format</td>
<td>&nbsp;</td>
</tr>
</table>

<h3>
<a NAME="refCodeGenerationArgs"></a>Code generation arguments</h3>

<table border cellspacing=0>

<tr>
<th>argument</th>
<th>effect</th>
<th>comment</th>
</tr>

<tr>
<td><a NAME="refArg_od"></a><span class="ncbi_app_a">-od &lt;file&gt;</span></td>
<td>C++ code <a href="#refDefFile">definition file</a></td>
<td>see <a href="#refDefFile">Definition file</a></td>
</tr>

<tr>
<td><span class="ncbi_app_a">-odi</span></td>
<td>ignore absent code definition file</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oA</span></td>
<td>generate C++ files for all types</td>
<td ROWSPAN="2">only types from main module are used
<br>(see <a href="#refArg_m"><span class="ncbi_app_a">-m</span></a> and <a href="#refArg_mx"><span class="ncbi_app_a">-mx</span></a> argument)</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-ot &lt;types&gt;</span></td>
<td>generate C++ files for listed types</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-ox &lt;types&gt;</span></td>
<td>exclude types from generation</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oX</span></td>
<td>turn off recursive type generation</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-of &lt;file&gt;</span></td>
<td>write list of generated C++ files</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oc &lt;file&gt;</span></td>
<td>write combining C++ files</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-on &lt;string&gt;</span></td>
<td>default namespace</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><a NAME="refArg_op"></a><span class="ncbi_app_a">-opm &lt;dir></span></td>
<td>directory for searching source modules</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oph &lt;dir&gt;</span></td>
<td>directory for generated *.hpp files</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-opc &lt;dir&gt;</span></td>
<td>directory for generated *.cpp files</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><a NAME="refArg_or"></a><span class="ncbi_app_a">-or &lt;prefix&gt;</span></td>
<td>add prefix to generated file names</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-orq</span></td>
<td>use quoted syntax form for generated include files</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-ors</span></td>
<td>add source file dir to generated file names</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-orm</span></td>
<td>add module name to generated file names</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-orA</span></td>
<td>combine all <a href="#refArg_or">-or*</a> prefixes</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oR &lt;dir&gt;</span></td>
<td>set <a href="#refArg_op">-op*</a> and <a href="#refArg_or">-or*</a>
arguments for NCBI dir tree</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-lax_syntax</span></td>
<td>allow non-standard ASN.1 syntax accepted by asntool</td>
<td>&nbsp;</td>
</tr>

<tr>
<td><span class="ncbi_app_a">-oex &lt;export&gt;</span></td>
<td>add storage-class modifier to generated classes</td>
<td>can be overriden by
<br><a href="#refDefCommon"> <span class="ncbi_keyword">[-]._export</span> </a>
in the definition file</td>
</tr>
</table>

<h2>
<a NAME="refDefFile"></a>Definition file</h2>
There is a possibility of fine tuning of code generation. It is performed
via definition file specified in <a href="#refArg_od"><span class="ncbi_app_a">-od</span></a> argument.
<br>
Definition file uses the <a href="../../programming_manual/registry.html#syntax">generic NCBI configuration</a> format (also used in the standard NCBI application configuration (*.ini) files.

files.
<p>Tuning parameters are searched in several sections:
<ol>
  <li>[ModuleName.TypeName]</li>
  <li>[TypeName]</li>
  <li>[ModuleName]</li>
</ol>
Prefix of parameter name in section is determined from location of element
we want to affect in ASN.1 definition.
<br>For root type itself prefix is empty.
<br>For element of 'SET OF' or 'SEQUENCE OF' add "E." to prefix.
<br>For element of 'SET', 'SEQUENCE' or 'CHOICE' add element name
and dot (".") to prefix.
<br>For example, if we have ASN.1 definitions:

<blockquote>
<pre class="ncbi_code">
<a NAME="refType_Date"></a>Date ::= CHOICE {
    <a NAME="refMember_Date_str"></a>str VisibleString,
    std <a href="#refType_Date_std">Date-std</a>
}
<a NAME="refType_Date_std"></a>Date-std ::= SEQUENCE {
    year INTEGER,     month INTEGER OPTIONAL
}
<a NAME="refType_Dates"></a>Dates ::= SEQUENCE OF <a href="#refType_Date">Date</a>    
<a NAME="refType_Int_fuzz"></a>Int-fuzz ::= CHOICE {
    p-m INTEGER,
    <a NAME="refMember_Int_fuzz_range"></a>range SEQUENCE {
        max INTEGER,
        <a NAME="refMember_Int_fuzz_range_min"></a>min INTEGER
    },
    pct INTEGER,
    lim ENUMERATED {
        unk (0),
        gt (1),
        lt (2),
        tr (3),
        tl (4),
        circle (5),
        other (255)
    },
    <a NAME="refMember_Int_fuzz_alt"></a>alt SET OF INTEGER
}
</pre>
</blockquote>


Then definitions:
<blockquote class="ncbi_code">[<a href="#refType_Date">Date</a>]
<br>&nbsp;&nbsp;&nbsp; <a href="#refMember_Date_str">str</a>._type = string
</blockquote>
will affect generation of <a href="#refMember_Date_str">str</a>
member in <a href="#refType_Date">Date</a></i> structure.

<blockquote class="ncbi_code">[<a href="#refType_Dates">Dates</a>]<br>
E._pointer = true
</blockquote>
will affect generation of elements in <a href="#refType_Dates">Dates</a> container.

<blockquote class="ncbi_code">[<a href="#refType_Int_fuzz">Int-fuzz</a>]<br>
<a href="#refMember_Int_fuzz_range">range</a>.<a href="#refMember_Int_fuzz_range_min">min</a>._type
= long
</blockquote>
will affect generation of <a href="#refMember_Int_fuzz_range_min">min</a>
member of <a href="#refMember_Int_fuzz_range">range</a> member of <a href="#refType_Int_fuzz">Int-fuzz</a> structure.

<blockquote class="ncbi_code">[<a href="#refType_Int_fuzz">Int-fuzz</a>]<br>
<a href="#refMember_Int_fuzz_alt">alt</a>.E._type = long
</blockquote>
will affect generation of elements of <a href="#refMember_Int_fuzz_alt">alt</a>
member of <a href="#refType_Int_fuzz">Int-fuzz</a> structure.
<br>

<a NAME="refDefCommon"></a>
<h3>Common definitions</h3>

Some definitions affect the whole generated type:

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><a NAME="refDef_file"></a><span class="ncbi_keyword">_file</span></td>

<td width="400">basename for generated C++ files</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><a NAME="refDef_dir"></a><span class="ncbi_keyword">_dir</span></td>

<td>subdirectory for generated C++ files
<br>(if <a href="#refDef_file" class="ncbi_keyword">_file</a> not specified)</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><a NAME="refDef_class"></a><span class="ncbi_keyword">_class</span></td>

<td>generated class name
<br>(if "-" then do not generated code for this type)</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><a NAME="refDef_namespace"></a><span class="ncbi_keyword">_namespace</span></td>

<td>namespace where to place generated class</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><a NAME="refDef_parent_class"></a><span class="ncbi_keyword">_parent_class</span></td>

<td>inherit generated C++ class from specified class</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td><a NAME="refDef_parent_type"></a><span class="ncbi_keyword">_parent_type</span></td>

<td NOSAVE>inherit generated C++ class from class corresponding to specified
type
<br>(if <a href="#refDef_parent_class" class="ncbi_keyword">_parent_class</a> not specified)</td>
</tr>
</table>

<br />
It is also possible to specify a storage-class modifier, which is required on Microsoft Windows
to export/import generated classes from/to a DLL. This setting affects all generated classes
in a module. Appropriate section of the definition file should look like this:
<blockquote class="ncbi_code">[-]<br />
_export = EXPORT_SPECIFIER
</blockquote>
Since this modifier could also be specified in the <a href="#refArg_od">command line</a>,
datatool code generator uses the followig rules to choose the proper one:
<ol>
  <li>
If no <span class="ncbi_app_a">-oex</span> flag is given in the command line,
then no modifier is added at all.
  </li>
  <li>
If <span class="ncbi_app_a">-oex &quot;&quot;</span>
(that is, an empty modifier) is specified in the command line,
then the modifier from the definition file will be used.
  </li>
  <li>
The command line parameter in the form 
<span class="ncbi_app_a">-oex FOOBAR</span> will cause
the generated classes to have <span class="ncbi_app_a">FOOBAR</span>
storage-class modifier, unless another one is specified in the definition file.
The modifier from the definition file always takes precedence.
  </li>
</ol>



<h3>
Definitions which affect specific types:</h3>

<h3>
<a NAME="refDefINT"></a>INTEGER, REAL, BOOLEAN, NULL:</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><span class="ncbi_keyword">_type</span></td>

<td width="400">C++ type (int, short, unsigned, long etc.)</td>
</tr>
</table>

<h3>
<a NAME="refDefENUM"></a>ENUMERATED</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><span class="ncbi_keyword">_type</span></td>

<td width="400">C++ type of variable (int, short, unsigned, long etc.)</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><span class="ncbi_keyword">_prefix</span></td>

<td>prefix for enum values' names (default "e")</td>
</tr>
</table>

<h3>
<a NAME="refDefOCTETS"></a>OCTET STRING</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE>
<td width="150" ><span class="ncbi_keyword">_char</span></td>

<td width="400">vector element type (char, unsigned char or signed char)</td>
</tr>
</table>

<h3>
<a NAME="refDefArray"></a>SEQUENCE OF, SET OF</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><span class="ncbi_keyword">_type</span></td>

<td width="400">STL container type (list, vector, set, multiset)</td>
</tr>
</table>

<h3>
<a NAME="refDefClass"></a>SEQUENCE, SET</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><span class="ncbi_keyword">memberName._delay</span></td>

<td width="400">mark specified member for <a href="#refDelayed">delayed reading</a></td>
</tr>
</table>

<h3>
<a NAME="refDefChoice"></a>CHOICE</h3>

<table border cellspacing=0>
<tr VALIGN=BASELINE NOSAVE>
<td width="150"><span class="ncbi_keyword">_virtual_choice</span></td>

<td width="400">if non empty, do not generate special class for choice
<br>instead make choice class as parent class for all its variants</td>
</tr>

<tr VALIGN=BASELINE NOSAVE>
<td NOSAVE><span class="ncbi_keyword">variantName._delay</span></td>

<td>mark specified variant for <a href="#refDelayed">delayed reading</a></td>
</tr>
</table>

<h2>
<a NAME="refCode"></a>Generated code</h2>

<h3>
<a NAME="refNormalizedName"></a>Normalized name</h3>

Everywhere in generated code we use so called NormalizedName which is produced
from ASN.1 type name by replacing all minuses ("-") with underscores ("_")
and making first letter capital.

<h3>
<a NAME="refCodeEnum"></a>ENUMERATED types</h3>
For every ENUMERATED type datatool will produce C++ enum type by default
having name E<a href="#refNormalizedName">NormalizedName</a>.
<h3>
<a NAME="refCodeClass"></a>SEQUENCE and SET code</h3>

<h3>
<a NAME="refCodeChoice"></a>CHOICE code</h3>

<h3>
<a NAME="refCodeOther"></a>Other types code</h3>

<br>
<!--#include virtual="../../ssi/navlinks.shtml" -->

<!-- Begin footer content -->

<table BORDER=0 CELLSPACING=0 WIDTH="100%" >
<tr>
<td ALIGN=LEFT>
<address>
<a NAME="copyright"></a><a href="mailto:cpp-core@ncbi.nlm.nih.gov">Eugene
Vasilchenko</a>&nbsp;</address>
</td>

<td>

<!-- <td align=center><span class="ncbi_cvs_rev">$Revision$</span></td> --></td>

<td ALIGN=RIGHT><span class="ncbi_cvs_date">$Date$</span></td>
</tr>
</table>

<!--#include virtual="../../ssi/footer.shtml" -->
