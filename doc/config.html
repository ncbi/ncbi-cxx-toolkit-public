<!-- $Id$ -->
<!--#set var="TITLE" value="NCBI C++ Toolkit:  Configure, Build and Install" -->
<!--#set var="HEADING" value="Configure, Build and Install the Toolkit" -->
<!--#set var="DOCROOT" value="." -->
<!--#include virtual="./ssi/header.shtml" -->
<i><h1><font color="#FF0000"><span style="background-color: #FFFFFF">Warning: This HTML page is deprecated</span></font></h1>

All new changes are being made to the Toolkit Book
at the following locations:
<ul>
<li>
<i>Official Release:</i> <a href="http://www.ncbi.nlm.nih.gov/books/bv.fcgi?call=bv.View..ShowTOC&rid=toolkit.TOC&depth=2">
    C++ Toolkit Book</a>.
</li>
<li>
<i>Development Version:</i> <a href="http://xpubmed0.ncbi.nlm.nih.gov:5701/books/bv.fcgi?call=bv.View..ShowTOC&rid=toolkit.TOC&depth=2">

    C++ Toolkit Book (no search engine, accessible from inside NCBI only)</a>. </li> </ul> The Development Version is the most recent documentation before it becomes an Official Release. While the Development Version is the lastest version, it is accessible only from inside NCBI, and the search engine functionality is currently missing. Also, the location of the Development Version may change without warning! So it is suggested that you use the Official Release, and use the Development Version only when necessary.</p> </i>

<hr>
<!--EOW-->

<a name="ref_ConfigTop"></a>

<p>
This page describes how to get the NCBI C++ sources, and how to
configure/deploy a build directory with the <span class="ncbi_file">ncbiconf.h</span> header and
all makefiles configured to work on the specified platform with
the specified compiler (and other tools) and flags.  For a basic discussion
of these issues, consult the <a href="get_started.html#ref_InstBasics">Getting Started</a> page.
<p>

<ul>
  <li> <a href="#ref_Source">
       NCBI C++ source code repository</a>
  <li> <a href="#ref_Configure">
       Configuration and installation script <span class="ncbi_script">configure</span></a>
  <li> <a href="#ref_Build">
          Structure of the build <span class="ncbi_term">tree</span> produced by <span class="ncbi_script">configure</span></a>
  <p>

  <li> <a href="#ref_Running">
       Running the <span class="ncbi_script">configure</span> script</a>
         <ul>
           <li> <a href="#ref_GetHelp">
            Getting synopsis of available configuration options</a>
           <li> <a href="#ref_DebugVsRelease">
            Debug vs. Release configuration</a>
           <li> <a href="#ref_DLL">
            Building shared libraries (DLLs)</a>
           <li> <a href="#ref_DLL_OK">
            Supported Platforms for DLL Builds</a>
           <li> <a href="#ref_RunPath">
            Hard-coding run-time DLL path into the executables and DLLs</a>
           <li> <a href="#ref_MT">
            Multi-Thread safe compilation, and linking with MT libraries</a>
           <li> <a href="#ref_64">
            Building in 64-bit mode</a>
           <li> <a href="#ref_GnuMakeAutodep">
            Automatic generation of dependencies (for GNU <span class="ncbi_util">make</span> only)</a>
           <li> <a href="#ref_NamingBuildTree">
            Naming the <span class="ncbi_term">build tree</span></a>
           <li> <a href="#ref_AfterConf">
            After-configure user callback script</a>
           <li> <a href="#ref_ToolsAndFlags">
            Tools and Flags</a>
         <li> <a href="#ref_Localization">
         Localization for the system and third-party packages</a>
         <li> <a href="#ref_ProhibitPackage">
         Prohibiting the use of some of the system and third-party packages</a>
         <li> <a href="#ref_Optional">
         Optional projects</a>
         <li> <a href="#ref_ProjectList">
         Finer-grained control of projects: <span class="ncbi_conf_flag">--with-projects</span></a>
         <li> <a href="#ref_Misc">
         Miscellaneous: <span class="ncbi_conf_flag">--without-exe, --without-execopy,
     --with-lib-rebuilds(=ask)</span></a>
         <li> <a href="#ref_Wrappers">
         Compiler-specific <span class="ncbi_script">configure</span> wrappers
         (<span class="ncbi_file">compilers/*.sh</span>) </a>
         <li> <a href="#ref_PreBuiltHeaders">
         Pre-built configuration headers
         (<span class="ncbi_file">compilers/ncbiconf.*</span>) </a>
         </ul>
  <p>

  <li> <a href="#ref_Reconf">
       Quick reconfiguration</a>
     </a>
  <li> <a href="#ref_Example">
       An example of configuration, installation and build</a>
  <li> <a href="#ref_Compilers">
       List of supported compilers</a>
  <p>

  <li> <a href="#ref_AdHoc">
       Ad-hoc installations</a>
     <ul>
        <li> <a href="#ref_MsvcProj">
          MS Visual C++</a>
       <ul>
          <li> <a href="#ref_MsvcProjDownload">
            Getting the Toolkit sources</a>
          <li> <a href="#ref_MsvcProjFiles">
            Working with project files</a>
          <li> <a href="#ref_MsvcProjTree">
            Building the whole NCBI C++ tree locally</a>
          <li> <a href="#ref_MsvcProjCXX">
            Using pre-built NCBI C++ Toolkit in your projects</a>
          <li> <a href="#ref_MsvcProjWxwin">
            Using wxWindows</a>
          <li> <a href="#ref_MsvcProjFltk">
            Using FLTK</a></li>
          <li> <a href="#ref_MsvcProjC">
            Using NCBI C Toolkit</a>
          <li> <a href="#ref_MsvcProjSettings">
            Mandatory project settings (RTTI, MT-safety)</a>
       </ul>
      </li>
        <li> <a href="#ref_Mac">
          Macintosh</a>
       <ul>
          <li> <a href="#ref_MacProjDownload">
            Getting the Toolkit sources</a>
          <li> <a href="#ref_MacProjTree">
            Building the whole NCBI C++ tree locally</a>
       </ul>
      </li>

        <li> <a href="config_darwin.html">
          Mac OS X (Darwin)</a>
       <ul>
          <li> <a href="config_darwin.html">
            Building the whole NCBI C++ tree locally</a>
       </ul>
      </li>
     </ul>
</ul>

<hr>

<a name="ref_Source"></a>
<h2>NCBI C++ source code repository <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
The NCBI C++ Toolkit sources and data can be
<a href="new_proj.html#ref_Checkout">retrieved</a> from the internal NCBI
CVS tree -- either directly from <span class="ncbi_cvs_path">"$CVSROOT/internal/c++/"</span>, or using
auxiliary scripts <span class="ncbi_script">scripts/cvs_core.sh</span></a> and
<span class="ncbi_script">scripts/cvs_core_msvc.bat</span>.

The resultant <a href="src_tree.gif">NCBI C++  source tree</a> will contain:
<ul>
  <li> set of files needed for the platform-specific
       <a href="#ref_Running">configuration and installation</a>:
       <ul>
         <li>  <span class="ncbi_script">configure</span> -- a multi-platform configuration shell
               script (generated from template <span class="ncbi_file">configure.ac</span> using
               <a href="http://sunland.gsfc.nasa.gov/info/autoconf/Top.html">
               <span class="ncbi_util">autoconf</span></a>)
         <li>  various scripts and template files used by
               <span class="ncbi_script">configure</span>,
               <a href="http://sunland.gsfc.nasa.gov/info/autoconf/Top.html">
               <span class="ncbi_util">autoconf</span></a> and
               <a href="http://sunland.gsfc.nasa.gov/info/autoconf/Invoking_autoheader.html">
               <span class="ncbi_util">autoheader</span></a>
         <li>  <span class="ncbi_dir">compilers/</span> -- directory containing
               <a href="#ref_Wrappers">
               compiler-specific configure wrappers</a>
               (<span class="ncbi_file">*.sh</span>) and
               <a href="#ref_PreBuiltHeaders">
               pre-built configuration headers</a>
               (<span class="ncbi_file">ncbiconf.*</span>) for some platforms
       </ul>

  <li> <span class="ncbi_dir">doc/</span> -- NCBI C++ documentation, manuals (including
       this one, <span class="ncbi_file">doc/config.html</span>) and guidelines
       for <em>everybody</em> writing on C++ in NCBI SWG

  <li> <span class="ncbi_dir">scripts/</span> -- auxiliary scripts, such as
          <a href="cvs.html#ref_Import_Project">
             <span class="ncbi_script">import_project.sh</span></a>,
          <a href="cvs.html#ref_New_Project">
             <span class="ncbi_script">new_project.sh</span></a>,
          <a href="cvs.html#ref_CVS_Core">
             <span class="ncbi_script">cvs_core.sh</span></a>,
        etc.

  <li> <span class="ncbi_dir">src/</span> -- a hierarchical directory tree of
       NCBI C++ projects. Here go
       all source files (<span class="ncbi_file">*.cpp, *.c</span>), private header and inline files
       (<span class="ncbi_file">*.hpp, *.inl, *.h</span>), makefiles (<span class="ncbi_file">Makefile.*</span>, including
       <a href="makefiles.html#ref_MakeProjMk"><span class="ncbi_file">Makefile.mk</span></a>),
       scripts (<span class="ncbi_file">*.sh</span>), and maybe some project-specific data

  <li> <span class="ncbi_dir">include/</span> -- a hierarchical directory tree whose
       structure mirrors the <span class="ncbi_dir">src/</span> directory tree. It
       contains only public header and inline files (<span class="ncbi_file">*.hpp, *.inl, *.h</span>).
       <br><span class="ncbi_note">Example</span>: <span class="ncbi_dir">include/corelib/</span> contains public headers for the sources
       located in <span class="ncbi_dir">src/corelib/</span>
</ul>

<hr>

<a name="ref_Configure"></a>
<h2>Configuration and installation script <span class="ncbi_script">configure</span> <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
Different compilers compile C++ (and even C!) code differently --
they may vary in the OS standard libraries and header files,
completeness of the C++ implementation, and... in compiler bugs.
There are also different <span class="ncbi_util">make</span> and other tools and
file naming conventions on different platforms.

<p>
Thus, a configuration is needed to encounter the platform-
and compiler-specific features.
For this purpose, we are using the GNU
<a href="http://sunland.gsfc.nasa.gov/info/autoconf/Top.html"><span class="ncbi_util">autoconf</span></a>
utility to automatically generate compiler-specific header file
<span class="ncbi_file">ncbiconf.h</span> and makefiles that would work for the given platform.

<p>
User performs both configuration and installation by merely running
platform-independent(<span class="ncbi_util">sh, bash</span>) shell script
<span class="ncbi_script">configure</span> (we pre-generate it in-house from template
<span class="ncbi_file">configure.ac</span> using
<a href="http://sunland.gsfc.nasa.gov/info/autoconf/Top.html">
<span class="ncbi_util">autoconf</span></a>).

<p>
During the configuration process, many compiler features are tested,
and the results of this testing are recorded in the configuration header
<span class="ncbi_file">ncbiconf.h</span> by the means of C preprocessor variables. E.g., the
preprocessor variable <span class="ncbi_var">NO_INCLASS_TMPL</span> indicates whether the
compiler supports template class methods; another example of the information
contained in <span class="ncbi_file">ncbiconf.h</span> are preprocessor variables used to
define <a href="types.html#ref_IntFixed">sized integer</a> and
<a href="types.html#ref_BigScalar">BigScalar</a> types.

<p>
The <span class="ncbi_script">configure</span> script will create so-called
<a href="bld_tree.gif"><span class="ncbi_term">build tree</span></a>
-- a hierarchy of directories where
object modules, libraries and executables are to be built.
<br>
It will also configure all <span class="ncbi_file">*.in</span> template files located
in the NCBI C++  source tree(<span class="ncbi_dir">src/</span>) and deploy
the resultant configured files in the relevant places of the
<a href="bld_tree.gif"><span class="ncbi_term">build tree</span></a>.

This way, all platform- and compiler-specific tools and flags will be "frozen"
inside the configured makefiles in the
<a href="bld_tree.gif"><span class="ncbi_term">build tree</span></a>.
And, the <span class="ncbi_file">ncbiconf.h</span> (described above, also configured for
the given compiler), will be put to the <span class="ncbi_dir">inc/</span> sub-directory
of the resultant
<a href="bld_tree.gif"><span class="ncbi_term">build tree</span></a>.

<p>
User can create as many such <span class="ncbi_term">build trees</span> as he needs.  All these
trees would refer to just the same (origin) NCBI C++
<a href="src_tree.gif">source tree</a> and include tree,
while each
<a href="bld_tree.gif"><span class="ncbi_term">build tree</span></a>
can contain its own (platform/compiler-specific)
<span class="ncbi_file">ncbiconf.h</span> header, and/or different set of compilation/linking/etc.
flags and tools ("frozen" in the makefiles, especially in
<a href="makefiles.html#ref_MakeProjMk"><span class="ncbi_file">Makefile.mk</span></a>).
This is to allow one to build
libraries and executables using different compilers and/or flags, yet from
the same sources, and in a uniform way.

<br></br>
<hr>

<a name="ref_Build"></a>
<h2>Structure of the build tree  produced by <span class="ncbi_script">configure</span> <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
Each configuration process results in a new <span class="ncbi_term">build tree</span>.
The structure of the tree is as follows (see also in
<a href="bld_tree.gif">chart</a>):
<ul>
  <li> <span class="ncbi_dir">inc/</span> -- contains
       <span class="ncbi_file">ncbiconf.h</span> configuration header generated by the
       <span class="ncbi_script">configure</span> script.
  <li> <span class="ncbi_dir">build/</span> -- contains a hierarchy of directories that
       correspond to those in the <span class="ncbi_dir">src/</span> (in NCBI C++ original
       sources). These directories will contain makefiles (<span class="ncbi_file">Makefile.*</span>)
       generated by the <span class="ncbi_script">configure</span> script from the makefile
       templates (<span class="ncbi_file">Makefile.*.in</span>) of corresponding project located in the
       source tree.
       <br>
       The resultant scripts and makefile will keep referencies
       to the original NCBI C++ source directories.
       <br>
       There is a "very special" file
       <a href="makefiles.html#ref_MakeProjMk"><span class="ncbi_file">Makefile.mk</span></a>
       that contains all configured
       <a href="#ref_ToolsAndFlags">tools, flags</a>
       and
       <a href="#ref_Localization">local paths</a>.
       This file is usually included by other makefiles.
       <br>
       Later, all build results (object modules, libraries and executables
       as well as any auxiliary files and directories created during the build)
       will go exclusively into the <span class="ncbi_term">build tree</span>, and not
       to the original NCBI C++ source directories. This allows one to
       have several build trees that use just the same sources, but
       compile and link them with different flags and/or compilers.
  <li> <span class="ncbi_dir">lib/</span> -- here go all public libraries built by the
       <span class="ncbi_dir">build/</span>-located projects.
  <li> <span class="ncbi_dir">bin/</span> -- here go all public executables built by the
       <span class="ncbi_dir">build/</span>-located projects.
  <li> <span class="ncbi_dir">status/</span> -- contains cache (<span class="ncbi_file">config.cache</span>),
       log file (<span class="ncbi_file">config.log</span>), and secondary configuration script
       (<span class="ncbi_file">config.status</span>) produced by <span class="ncbi_script">configure</span> during
       the configuration process.
</ul>

<hr>

<a name="ref_Running"></a>
<h2>Running the <span class="ncbi_script">configure</span> script <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
<a name="ref_GetHelp"></a>
<h4>Getting synopsis of available configuration options</h4>

<dl>
    <dt>
    <dd>
To get the list of <a href="configure_options.txt">available configuration options</a>, just run
<span class="ncbi_cmd">configure --help</span>.
You can see the NCBI-specific options at the very end of the printout.
<br>
<span class="ncbi_note">NOTE:</span> Do not use the "standard" configure options listed
in the <span class="ncbi_menu">"Directory and file names:"</span> section of the help printout (such as
<span class="ncbi_conf_flag">--prefix=, --bindir=</span>, etc.), as they are not used by the NCBI
<span class="ncbi_script">configure</span> script.
</dl>

<p>
<a name="ref_DebugVsRelease"></a>
<h4><span class="ncbi_dir">Debug</span> vs. <span class="ncbi_dir">Release</span> configuration</h4>

<dl>
    <dt>
    <dd>
The following two <span class="ncbi_script">configure</span> flags control whether to target for
the <span class="ncbi_dir">Debug</span> or <span class="ncbi_dir">Release</span> version. These options (default is
<span class="ncbi_conf_flag">--with-debug</span>) control the appearance of preprocessor
flags <span class="ncbi_make_flag">-D_DEBUG</span> and <span class="ncbi_make_flag">-DNDEBUG</span>, and compiler/linker flags
<span class="ncbi_make_flag">-g</span> and <span class="ncbi_make_flag">-O</span>, respectively:
<ul>
  <li> <span class="ncbi_conf_flag">--with-debug</span> --
       engage <span class="ncbi_make_flag">-D_DEBUG</span> and <span class="ncbi_make_flag">-g</span>,
       <br>strip <span class="ncbi_make_flag">-DNDEBUG</span> and <span class="ncbi_make_flag">-O</span>
       (if not <span class="ncbi_conf_flag">--with-optimization</span>)
  <li> <span class="ncbi_conf_flag">--without-debug</span> --
       strip <span class="ncbi_make_flag">-D_DEBUG</span> and <span class="ncbi_make_flag">-g</span>,
       <br>engage <span class="ncbi_make_flag">-DNDEBUG</span> and <span class="ncbi_make_flag">-O</span>
         (if not <span class="ncbi_conf_flag">--without-optimization</span>)
  <li> <span class="ncbi_conf_flag">--with-optimization</span> --
       unconditionally engage <span class="ncbi_make_flag">-DNDEBUG</span> and <span class="ncbi_make_flag">-O</span>
  <li> <span class="ncbi_conf_flag">--without-optimization</span> --
       unconditionally strip <span class="ncbi_make_flag">-DNDEBUG</span> and <span class="ncbi_make_flag">-O</span>
  <li> default: <span class="ncbi_conf_flag">--with-debug --without-optimization</span>
</ul>
</dl>

<p>
<a name="ref_DLL"></a>
<h4>Building shared libraries (DLLs)</h4>

<dl>
    <dt>
    <dd>
On the capable platforms, you can build libraries as <span class="ncbi_term">shared (dynamic)</span>.
<ul>
  <li> <span class="ncbi_conf_flag">--with-dll --with-static</span> --
       build libraries as both <span class="ncbi_term">dynamic</span> and <span class="ncbi_term">static</span>; <br>
         however, if the library project makefile specifies
         <a href="new_proj.html#ref_MakeProjLib"><span class="ncbi_make_var">LIB_OR_DLL = lib</span></a>,
       then build the library as <span class="ncbi_term">static</span> only, and if the
       library project makefile specifies
         <a href="new_proj.html#ref_MakeProjLib"><span class="ncbi_make_var">LIB_OR_DLL = dll</span></a>
       then build the library as <span class="ncbi_term">dynamic</span> only. <br>
       Note that the resulting static libraries consist of
       position-independent objects.
  <li> <span class="ncbi_conf_flag">--with-dll</span> --
       build libraries as <span class="ncbi_term">dynamic</span>; <br>
         however, if the library project makefile specifies
         <a href="new_proj.html#ref_MakeProjLib"><span class="ncbi_make_var">LIB_OR_DLL = lib</span></a>,
       then build the library as <span class="ncbi_term">static</span>
  <li> <span class="ncbi_conf_flag">--without-dll</span> --
       always build <span class="ncbi_term">static</span> libraries, <br>
         even if the library project makefile specifies
         <a href="new_proj.html#ref_MakeProjLib"><span class="ncbi_make_var">LIB_OR_DLL = dll</span></a>
  <li> default:
       build libraries as <span class="ncbi_term">static</span>; <br>
         however, if the library project makefile specifies
          <a href="new_proj.html#ref_MakeProjLib"><span class="ncbi_make_var">LIB_OR_DLL = dll</span></a>,
       then build the library as <span class="ncbi_term">dynamic</span>
</ul>
</dl>

<p>
<a name="ref_DLL_OK"></a>
<h4>Supported Platforms for DLL Builds</h4>

<dl>
    <dt>
    <dd>
We have succeeded in building NCBI C++ Toolkit libs as DLLs on at least
the following platforms:
<ul>
  <li> <a href="http://gcc.gnu.org/">
       <span class="ncbi_compiler">GCC 2.95.[1,2]</span></a>
    <ul>
      <li> Linux RedHat 5.2 and higher --- <span class="ncbi_platform">PC-Intel</span> </li>
      <li> IRIX64 6.5 --- <span class="ncbi_platform">SGI-Mips</span> </li>
      <li> Solaris 2.6, 2.7, 2.8 --- <span class="ncbi_platform">SUN-Sparc</span> and <span class="ncbi_platform">PC-Intel</span>
           (requires <span class="ncbi_lib">libstd++.so</span>!) </li>
    </ul>
        </li>

  <li> <a href="http://gcc.gnu.org/">
       <span class="ncbi_compiler">GCC 3.0.1</span></a>
    <ul>
      <li> Linux RedHat 6.2 and higher --- <span class="ncbi_platform">PC-Intel</span> </li>
      <li> Solaris 2.8 and higher --- <span class="ncbi_platform">SUN-Sparc</span> </li>
    </ul>
        </li>

  <li> <a href="http://www.sun.com/workshop/visual/">
       <span class="ncbi_compiler">Sun WorkShop 5.1, 5.2 and 5.3</span></a>
    <ul>
      <li>All configurations listed in the <a href="#ref_Compilers">List of supported compilers</a>
                (see below)</li>
    </ul>
  </li>

  <li> <u><span class="ncbi_compiler">MIPSpro 7.3.1.1m, 7.3.1.2m (-n32)</span></u>
    <ul>
      <li> IRIX64 6.5 --- <span class="ncbi_platform">SGI-Mips</span> </li>
    </ul>
  </li>

  <li> <a href="http://www.kai.com/C_plus_plus/">
       <span class="ncbi_compiler">KAI C++ (KCC) 4.0</span></a>
    <ul>
      <li> Solaris 2.7 and higher --- <span class="ncbi_platform">SUN-Sparc</span> </li>
      <li> Linux RedHat 6.2 --- <span class="ncbi_platform">PC-Intel</span></li>
    </ul>

  <li> <a href="http://developer.intel.com/software/products/compilers/c50/linux/">
       <span class="ncbi_compiler">IntelC++ (ICC) 5.0 (beta)</span></a>
    <ul>
      <li> Linux RedHat 6.2 and higher --- <span class="ncbi_platform">PC-Intel</span></li>
    </ul>
  </li>
</ul>

On any other platform, the <span class="ncbi_conf_flag">--without-dll</span> scenario will be
enforced unconditionally (even if you explicitly specified
<span class="ncbi_conf_flag">--with-dll</span>).
</dl>

<p>
<a name="ref_RunPath"></a>
<h4>Hard-coding run-time DLL path into the executables and DLLs</h4>

<dl>
    <dt>
    <dd>
In order to be able to run executables linked against
dynamic libraries (DLLs), you have to specify these DLLs' location
(runpath). It can be done by hard-coding (using linker flags like
<span class="ncbi_make_flag">-R.....</span>) the <span class="ncbi_term">runpath</span> into the executables.
<ul>
  <li><span class="ncbi_conf_flag">--with-runpath</span> --
    hard-code the path to the <span class="ncbi_dir">lib/</span> dir
    of the Toolkit <span class="ncbi_term">build tree</span>
  </li>
  <li><span class="ncbi_conf_flag">--with-runpath=/foo/bar</span> --
    hard-code the path to the user-defined <span class="ncbi_dir">/foo/bar</span> dir
  </li>
  <li><span class="ncbi_conf_flag">--without-runpath</span> --
    do not hard-code any <span class="ncbi_term">runpath</span>
  </li>
  <li>default:
    if <span class="ncbi_conf_flag">--without-dll</span> flag is specified, then
    act as if <span class="ncbi_conf_flag">--without-runpath</span> was specified;
    otherwise engage the <span class="ncbi_conf_flag">--with-runpath</span> scenario.
  </li>
</ul>
<p>The preprocessor macro <span class="ncbi_macro">NCBI_RUNPATH</span> will be set to the resulting
runpath, if any, as a (possibly empty) string.

<p><span class="ncbi_note">NOTE:</span>
You also can use environment variable <span class="ncbi_env">$LD_LIBRARY_PATH</span> to specify
the runpath, like this:
<pre class="ncbi_cmd">
setenv LD_LIBRARY_PATH "/home/USERNAME/c++/WorkShop6-ReleaseDLL/lib"
/home/USERNAME/c++/WorkShop6-ReleaseDLL/bin/coretest
</pre>

<span class="ncbi_note">HINT:</span>
The <span class="ncbi_conf_flag">--with-runpath=....</span> option can be useful for the
building of production DLLs and executables, which are meant to use
production DLLs. The latter are usually installed not in the
<span class="ncbi_dir">lib/</span> dir of your development tree (<span class="ncbi_term">build tree</span>),
but at some well-known dir of your production site.<br>

Thus, you can do the development in a "regular" manner (i.e.
in a <span class="ncbi_term">build tree</span> configured using just <span class="ncbi_conf_flag">--with-runpath</span>),
and then when you want to build a production version (which is to use lets say
DLLs installed in "/some_path/foo/") you must re-configure your
C++ build tree with just the same options as before, plus
<span class="ncbi_conf_flag">"--with-runpath=/some_path/foo"</span>, then re-build the DLLs and
executables and install them into production. <br>

Then you can re-re-configure your <span class="ncbi_term">build tree</span> back with its original flags
(without the "<span class="ncbi_conf_flag">--with-runpath=/some_path/foo"</span>), and continue with
your development cycle, again using local in-tree DLLs.
</dl>


<p>
<a name="ref_MT"></a>
<h4>Multi-Thread safe compilation, and linking with MT libraries</h4>

<ul>
  <li> <span class="ncbi_conf_flag">--with-mt</span> --
          compile all code in an MT-safe manner; link with
        the system thread library
  <li> <span class="ncbi_conf_flag">--without-mt</span> --
          compile with no regard to the MT-safety
  <li> default: <span class="ncbi_conf_flag">--without-mt</span>
</ul>
<dl>
    <dt>
    <dd>
</dl>



<p>
<a name="ref_64"></a>
<h4>Building in 64-bit mode</h4>

<ul>
  <li> <span class="ncbi_conf_flag">--with-64</span> --
          compile all code and build executables in 64-bit mode
  <li> default: <span class="ncbi_conf_flag">--without-64</span>
</ul>
<dl>
    <dt>
    <dd>
</dl>


<p>
<a name="ref_GnuMakeAutodep"></a>
<h4>Automatic generation of dependencies (for GNU <span class="ncbi_util">make</span> only)</h4>

<ul>
  <li> <span class="ncbi_conf_flag">--with-autodep</span> --
          add build rules to automagically generate dependencies for the
          compiled C/C++ sources
  <li> <span class="ncbi_conf_flag">--without-autodep</span> --
          do not add these rules
  <li>  default:  detect if the <span class="ncbi_util">make</span> command actually calls
          GNU <span class="ncbi_util">make</span>;  if it does, then <span class="ncbi_conf_flag">--with-autodep</span>, else
          <span class="ncbi_conf_flag">--with-autodep</span>
</ul>

<dl>
    <dt>
    <dd>
Also, you can always switch between these two variants "manually", after
the configuration is done, by setting the value of variable
<span class="ncbi_make_var">Rules</span> in
<a href="makefiles.html#ref_MakeProjMk"><span class="ncbi_file">Makefile.mk</span></a>
to either <span class="ncbi_term">rules</span> or <span class="ncbi_make_var">rules_with_autodep</span>.

<p>
<span class="ncbi_note">NOTE:</span> You <em>must</em> use GNU <span class="ncbi_util">make</span> if you configured with
<span class="ncbi_conf_flag">--with-autodep</span>, as in this case the makefiles would use
very specific GNU <span class="ncbi_util">make</span> features!
</dl>


<p>
<a name="ref_NamingBuildTree"></a>
<h4>Naming the <span class="ncbi_term">build tree</span></h4>

<dl>
    <dt>
    <dd>
The configuration process will produce the new <span class="ncbi_term">build tree</span>
in some default subdirectory of the root source directory, and the base name
of this subdirectory will reflect the compiler name and a <span class="ncbi_dir">Release/Debug</span>
suffix, e.g.:  <span class="ncbi_dir">GCC-Release/</span>. The default <span class="ncbi_term">build tree</span>
name can be alternated by passing the following flags to the
<span class="ncbi_script">configure</span> script:
<ul>
  <li> <span class="ncbi_conf_flag">--without-suffix</span> --
       do not add <span class="ncbi_dir">Release/Debug</span>, <em>MT</em>, and/or <em>DLL</em> suffix(es)
       to the <span class="ncbi_term">build tree</span> name
       <br><span class="ncbi_note">Example:</span>
       <span class="ncbi_dir">GCC/</span> instead of <span class="ncbi_dir">GCC-ReleaseMT/</span>
  <li> <span class="ncbi_conf_flag">--with-hostspec</span> --
       add full host specs to the <span class="ncbi_term">build tree</span> name
       <br><span class="ncbi_note">Example:</span><span class="ncbi_dir">GCC-Debug--i586-pc-linux-gnu/</span>
  <li> <span class="ncbi_conf_flag">--with-build-root=/home/foo/bar</span> --
       specify your own <span class="ncbi_term">build tree</span> path and name
</ul>

With <span class="ncbi_conf_flag">--with-build-root=</span> you still can explicitly use
<span class="ncbi_conf_flag">--with-suffix</span> and <span class="ncbi_conf_flag">--with-hostspec</span>
to add suffix(es) to your <span class="ncbi_term">build tree</span> name in a manner described above.
<br><span class="ncbi_note">Example:</span>
<span class="ncbi_conf_flag">--with-build-root=/home/foo/bar</span>
<span class="ncbi_conf_flag">--with-mt </span>
<span class="ncbi_conf_flag">--with-suffix</span>
would deploy the new <span class="ncbi_term">build tree</span> in
<span class="ncbi_dir">/home/foo/bar-DebugMT</span>.

<p>
There is also a special case with "<span class="ncbi_conf_flag">--with-build-root=."</span>
for those who prefer to put object files, libraries and executables to where
the sources are located. But be advised that this will disallow you
to configure for other <span class="ncbi_term">build trees</span>.
</dl>

<p>
<a name="ref_AfterConf"></a>
<h4>After-configure user callback script</h4>

<dl>
    <dt>
    <dd>
You can specify your own script to call from the <span class="ncbi_script">configure</span>
script after the configuration is complete:
<ul>
  <li> <span class="ncbi_conf_flag">--with-extra-action="&lt;some_action&gt;"</span>
</ul>

<p>
where <span class="ncbi_value">&lt;some_action&gt;</span> can be some script with parameters.
The trick here is that in the <span class="ncbi_value">&lt;some_action&gt;</span> string, all
occurrences of "<span class="ncbi_note">{}</span>" will be replaced by the build dir name.

<p>
<span class="ncbi_note">Example:</span>
<p class="ncbi_cmd">&nbsp;&nbsp;&nbsp;configure --with-extra-action="echo foobar {}"</p>

<p>will execute (after the configuration is done):
<p class="ncbi_cmd">&nbsp;&nbsp;&nbsp;echo foobar /home/user/c++/GCC-Debug</p>
</dl>


<p>
<a name="ref_ToolsAndFlags"></a>
<h4>Tools and flags</i></h4>

<dl>
    <dt>
    <dd>
There is a predefined set of tools and flags used in the build process.
User can alternate these tools and flags by setting the following
environment variables for the <span class="ncbi_script">configure</span> script.
In particular, if you intend to debug the toolkit with Insure++, you
should run <span class="ncbi_script">configure</span> with <span class="ncbi_env">CC</span> and <span class="ncbi_env">CXX</span> set to <span class="ncbi_value">insure</span>.

<br><br>
<a name="ref_TableToolsAndFlags"></a>
<table border=1 cellspacing=0>
  <tr>
     <th>Name</th>
     <th>Default</th>
     <th>Synopsis</th>
  </tr>

  <tr>
     <td><span class="ncbi_env">CC</span></td>
     <td><span class="ncbi_util">gcc, cc</span></td>
     <td>C compiler</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CXX</span></td>
     <td><span class="ncbi_util">c++, g++, gcc, CC, cxx, cc++</span></td>
     <td>C++ compiler, also being used as a linker</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CPP</span></td>
     <td>$CC -E</td>
     <td>C preprocessor</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CXXCPP</span></td>
     <td>$CXX -E</td>
     <td>C++ preprocessor</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">AR</span></td>
     <td>ar cru</td>
     <td>Librarian</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">STRIP</span></td>
     <td>strip</td>
     <td>To discard symbolic info</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CFLAGS</span></td>
     <td>-g
     <a href="#ref_DebugVsRelease">or/and/nor</a>
     -O</td>
     <td>C compiler flags</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CXXFLAGS</span></td>
     <td>-g
     <a href="#ref_DebugVsRelease">or/and/nor</a>
     -O</td>
     <td>C++ compiler flags</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CPPFLAGS</span></td>
     <td>-D_DEBUG
     <a href="#ref_DebugVsRelease">or/and/nor</a>-DNDEBUG</td>
     <td>C/C++ preprocessor flags</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">LDFLAGS</span></td>
     <td>none</td>
     <td>Linker flags</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">LIBS</span></td>
     <td>none</td>
     <td>Libraries to link to every executable</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CONFIG_SHELL</span></td>
     <td><span class="ncbi_util">/bin/sh</span></td>
     <td>Command interpreter to use in the configuration scripts and makefiles
         (it must be compatible with <span class="ncbi_util">sh</span>)</td>
  </tr>
</table>

<p>
<a href="makefiles.html#ref_MakeProjMk">Later</a>, these tools and flags will
be engaged in the makefiles:
<a name="ref_StdBuildRules"></a>
<ul>
  <li> To compile C sources:
    <br> <span class="ncbi_cmd">$(CC) -c $(CFLAGS) $(CPPFLAGS) .....</span>
  <li> To compile C++ sources:
    <br> <span class="ncbi_cmd">$(CXX) -c $(CXXFLAGS) $(CPPFLAGS) .....</span>
  <li> To compose a library:
    <br> <span class="ncbi_cmd"> $(AR)     libXXX.a xxx1.o xxx2.o xxx3.o .....</span>
    <br> <span class="ncbi_cmd"> $(RANLIB) libXXX.a</span>
  <li> To link an executable:
    <br> <span class="ncbi_cmd">$(LINK) $(LDFLAGS) ..... $(LIBS)</span>
</ul>

For more info on these and other variables see in the
<a href="http://sunland.gsfc.nasa.gov/info/autoconf/Preset_Output_Variables.html">autoconf documentation</a>.
The specified tools and flags will then be "frozen" inside the makefiles of
<span class="ncbi_term">build tree</span> produced by this <span class="ncbi_script">configure</span> run.
</dl>

<p>
<a name="ref_Localization"></a>
<h4>Localization for the system and third-party packages</h4>

<dl>
    <dt>
    <dd>
There is some configuration info that usually cannot be guessed or detected
automatically, and thus in most cases it must be specified "manually" for
the given local host's working environment.

The following localization environment variables can be set in addition
to the "generic" ones
<a href="#ref_ToolsAndFlags">
<span class="ncbi_env">(CC, CXX, CPP, AR,RANLIB, STRIP, CFLAGS, CXXFLAGS, CPPFLAGS, LDFLAGS, LIBS)
</span></a>:

<br></br>
<a name="ref_TableLocalization"></a>
<table border=1 cellspacing=0>
  <caption>User-defined localization variables</caption>
  <tr>
     <th>Name</th>
     <th>Default</th>
     <th>Synopsis</th>
  </tr>

  <tr>
     <td><span class="ncbi_env">THREAD_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lpthread</span></td>
     <td>System thread library</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">NETWORK_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lsocket -lnsl</span></td>
     <td>System network libraries</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">MATH_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lm</span></td>
     <td>System math library</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">KSTAT_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lkstat</span></td>
     <td>System kernel statistics library</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">RPCSVC_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lrpcsvc</span></td>
     <td>System RPC services library</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">CRYPT_LIBS</span></td>
     <td><span class="ncbi_make_flag">-lcrypt[_i]</span></td>
     <td>System encrypting library</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">SYBASE_PATH</span></td>
     <td><span class="ncbi_dir">/netopt/Sybase/clients/current</span></td>
     <td>Path to Sybase package
     (but see <a name="ref_Sybase_NOTE">note</a> below)</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">FTDS_PATH</span></td>
     <td><span class="ncbi_dir">/netopt/Sybase/clients-mssql/current</span></td>
     <td>Path to FreeTDS package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">FASTCGI_PATH<br></span></td>
     <td><span class="ncbi_dir">$NCBI/fcgi-current</span></td>
     <td>Path to the in-house Fast-CGI client lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">FLTK_PATH<br></span></td>
     <td><span class="ncbi_dir">$NCBI/fltk</span></td>
     <td>Path to the FLTK package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">WXWIN_PATH<br></span></td>
     <td><span class="ncbi_dir">$NCBI/wxwin</span></td>
     <td>Path to the wxWindows package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">NCBI_C_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI</span></td>
     <td>Path to the NCBI C Toolkit</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">NCBI_SSS_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI/sss/BUILD</span></td>
     <td>Path to the NCBI SSS package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">NCBI_GEO_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI/geo</span></td>
     <td>Path to the NCBI GEO package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">SP_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI/SP</span></td>
     <td>Path to the SP package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">NCBI_PM_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI/pubmed[64]</span></td>
     <td>Path to the NCBI PubMed package</td>
  </tr>

  <tr>
     <td><span class="ncbi_env">ORBACUS_PATH</span></td>
     <td><span class="ncbi_dir">$NCBI/corba/OB-4.0.1</span></td>
     <td>Path to the ORBacus CORBA package</td>
  </tr>

</table>

<p>
<a name="ref_Sybase_NOTE"></a>
<span class="ncbi_note">Note:</span> It is also possible to make <span class="ncbi_script">configure</span> look
elsewhere for Sybase by means of <span class="ncbi_conf_flag">--with-sybase-local[=DIR]</span>.
If you specify a directory, it will override <span class="ncbi_env">SYBASE_PATH</span>;
otherwise, the default will change to
<span class="ncbi_dir">/export/home/sybase/clients/current</span>, but <span class="ncbi_env">SYBASE_PATH</span>
will still take priority.  Also, the option
<span class="ncbi_conf_flag">--with-sybase-new</span> will change the default version of
Sybase from 12.0 to 12.5 and adapt to its layout.
<p>
It is also possible to override <span class="ncbi_env">WXWIN_PATH</span> by
<span class="ncbi_conf_flag">--with-wxwin=DIR</span>, <span class="ncbi_env">FLTK_PATH</span> by -->
<span class="ncbi_conf_flag">--with-fltk=DIR</span>, and <span class="ncbi_env">ORBACUS_PATH</span> by
<span class="ncbi_conf_flag">--with-orbacus=DIR</span>.
<p>
Based on the above, <span class="ncbi_script">configure</span> will derive the following variables
to use in the generated makefiles:

<br></br>
<a name="ref_TableLocalization1"></a>
<table border=1 cellspacing=0>
  <caption>Derived localization variables for makefiles</caption>
  <tr>
     <th>Name</th>
     <th>Value</th>
     <th>Used to...</th>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">THREAD_LIBS</span></td>
     <td>$THREAD_LIBS</td>
     <td>link with system thread lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NETWORK_LIBS</span></td>
     <td>$NETWORK_LIBS</td>
     <td>link with system network libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">MATH_LIBS</span></td>
     <td>$MATH_LIBS</td>
     <td>link with system math lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">KSTAT_LIBS</span></td>
     <td>$KSTAT_LIBS</td>
     <td>link with system kernel stat lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">RPCSVC_LIBS</span></td>
     <td>$RPCSVC_LIBS</td>
     <td>link with system RPC lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">CRYPT_LIBS</span></td>
     <td>$CRYPT_LIBS</td>
     <td>link with system encrypting lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SYBASE_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$SYBASE_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> Sybase headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SYBASE_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$SYBASE_PATH/lib[64]</span> <br>
       -lblk[_r][64] -lct[_r][64] -lcs[_r][64] <br>
       -ltcl[_r][64] -lcomn[_r][64] -lintl[_r][64]
     </td>
     <td>link with Sybase libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SYBASE_DLLS</span></td>
     <td>-ltli[_r][64]</td>
     <td>Sybase DLL-only libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SYBASE_DBLIBS</span></td>
     <td>-L<span class="ncbi_dir">$SYBASE_PATH/lib[64]</span> <br>
       -lsybdb[64]
     </td>
     <td>link with Sybase DB Lib API</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FTDS_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$FTDS_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> FreeTDS headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FTDS_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$FTDS_PATH/lib</span> <br>
       -lsybdb -ltds
     </td>
     <td>link with the FreeTDS API</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FASTCGI_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$FASTCGI_PATH/include[64]</span></td>
     <td><span class="ncbi_ccode">#include</span> Fast-CGI headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FASTCGI_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$FASTCGI_PATH/lib[64]</span> -lfcgi
        <br> or <br>
        -L<span class="ncbi_dir">$FASTCGI_PATH/altlib[64]</span> -lfcgi </td>
     <td>link with Fast-CGI lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FLTK_INCLUDE</span></td>
     <td>-I$FLTK_PATH<span class="ncbi_dir">/include</span></td>
     <td><span class="ncbi_ccode">#include</span> FLTK headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">FLTK_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$FLTK_PATH/[GCC-]{Release|Debug}[MT][64]/lib</span> <br>
        -lfltk ... -lXext -lX11 ...
        <br> or <br>
        -L<span class="ncbi_dir">$FLTK_PATH/lib</span> ..... </td>
     <td>link with FLTK libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">WXWIN_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$WXWIN_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> wxWindows headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">WXWIN_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$WXWIN_PATH/[GCC-]{Release|Debug}/lib</span> <br>
        -lwx_gtk[d]  -lgtk  -lgdk  -lgmodule  -lglib
        <br> or <br>
        -L<span class="ncbi_dir">$WXWIN_PATH/lib</span> ..... </td>
     <td>link with wxWindows libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_C_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$NCBI_C_PATH/include[64]</span></td>
     <td><span class="ncbi_ccode">#include</span> NCBI C Toolkit headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_C_LIBPATH</span></td>
     <td>-L<span class="ncbi_dir">$NCBI_C_PATH/lib[64]</span>
        <br> or <br>
        -L<span class="ncbi_dir">$NCBI_C_PATH/altlib[64]</span></td>
     <td>path to NCBI C Toolkit libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_C_ncbi</span></td>
     <td>-lncbi</td>
     <td>NCBI C Toolkit CoreLib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_SSS_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$NCBI_SSS_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> NCBI SSS headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_SSS_LIBPATH</span></td>
     <td>-L<span class="ncbi_dir">$NCBI_SSS_PATH/lib/.... <br>
                     ....{Release|Debug}[GNU][64][mt]</span>
    </td>
     <td>link with NCBI SSS libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_GEO_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$NCBI_GEO_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> NCBI GEO headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_GEO_LIBPATH</span></td>
     <td>-L<span class="ncbi_dir">$NCBI_GEO_PATH/lib/.... <br>
                     ...[GCC-|KCC-|ICC-]{Release|Debug}[64]</span>
    </td>
     <td>link with NCBI GEO libs</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SP_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$SP_PATH/include</span></td>
     <td><span class="ncbi_ccode">#include</span> SP headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">SP_LIBS</span></td>
     <td>-L<span class="ncbi_dir">$SP_PATH/{Release|Debug}[MT][64]</span> <br>
         -lsp</td>
     <td>link with the SP lib</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">NCBI_PM_PATH</span></td>
     <td>$NCBI_PM_PATH</td>
     <td>path to the PubMed package</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">ORBACUS_INCLUDE</span></td>
     <td>-I<span class="ncbi_dir">$ORBACUS_PATH/include</span><br>
         -I<span class="ncbi_dir">$ORBACUS_PATH/{Release|Debug}[MT][64]/inc</span></td>
     <td><span class="ncbi_ccode">#include</span> ORBacus CORBA headers</td>
  </tr>

  <tr>
     <td><span class="ncbi_make_var">ORBACUS_LIBPATH</span></td>
     <td>-L<span class="ncbi_dir">$ORBACUS_PATH/{Release|Debug}[MT][64]/lib</span>
    </td>
     <td>link with ORBacus CORBA libs</td>
  </tr>

</table>
&nbsp;<p>
</dl>

<p>
<a name="ref_ProhibitPackage"></a>
<h4>Prohibiting the use of some of the system and third-party packages</h4>

<dl>
    <dt>
    <dd>
Some of the above system and third-party packages can
be prohibited to use -- using the following <span class="ncbi_script">configure</span>
flags:

<ul>
  <li> <span class="ncbi_conf_flag">--without-sybase</span> (Sybase) </li>
  <li> <span class="ncbi_conf_flag">--without-ftds</span> (FreeTDS) </li>
  <li> <span class="ncbi_conf_flag">--without-fastcgi</span> (Fast-CGI) </li>
  <li> <span class="ncbi_conf_flag">--without-fltk</span> (FLTK) </li>
  <li> <span class="ncbi_conf_flag">--without-wxwin</span> (wxWindows) </li>
  <li> <span class="ncbi_conf_flag">--without-ncbi-c</span> (NCBI C Toolkit) </li>
  <li> <span class="ncbi_conf_flag">--without-sssdb</span> (NCBI SSS DB) </li>
  <li> <span class="ncbi_conf_flag">--without-sssutils</span> (NCBI SSS UTILS) </li>
  <li> <span class="ncbi_conf_flag">--without-sss</span>
          (both <span class="ncbi_conf_flag">--without-sssdb</span> and <span class="ncbi_conf_flag">--without-sssutils</span>) </li>
  <li> <span class="ncbi_conf_flag">--without-geo</span> (NCBI GEO) </li>
  <li> <span class="ncbi_conf_flag">--without-sp</span> (NCBI SP) </li>
  <li> <span class="ncbi_conf_flag">--without-pubmed</span> (NCBI PubMed) </li>
  <li> <span class="ncbi_conf_flag">--without-orbacus</span> (ORBacus CORBA) </li>
</ul>
</dl>

<p>
<a name="ref_Optional"></a>
<h4>Optional projects</h4>

<dl>
    <dt>
    <dd>
You can control whether to build the following core packages
using the following <span class="ncbi_script">configure</span> flags:
<ul>
  <li> <span class="ncbi_conf_flag">--without-serial</span> --
          do not build C++ ASN.1 serialization library and
          <a href="tools/datatool/datatool.html">datatool</a>;
          <br> see in <span class="ncbi_dir">internal/c++/{
                <a href="lxr/source/src/serial">src</a>
                |
                <a href="lxr/source/include/serial">include</a>
                }/serial</span> directories
  </li>
  <li> <span class="ncbi_conf_flag">--without-ctools</span> --
          do not build projects that use NCBI C Toolkit
          <br> see in <span class="ncbi_dir">internal/c++/{
                <a href="lxr/source/src/ctools">src</a>
                |
                <a href="lxr/source/include/ctools">include</a>
                }/ctools</span> directories
  </li>
  <li> <span class="ncbi_conf_flag">--without-gui</span> --
          do not build projects that use wxWindows GUI package
          <br> see in <span class="ncbi_dir">internal/c++/{
                <a href="lxr/source/src/gui">src</a>
                |
                <a href="lxr/source/include/gui">include</a>
                }/gui</span> directories
  </li>
</ul>

<ul>
  <li> <span class="ncbi_conf_flag">--with-objects</span> --
          generate and build libraries to serialize ASN.1 objects;
          <br> see in <span class="ncbi_dir">internal/c++/{
                <a href="lxr/source/src/objects">src</a>
                |
                <a href="lxr/source/include/objects">include</a>
                }/objects</span> directories
  </li>
  <li> <span class="ncbi_conf_flag">--with-internal</span> --
          build of internal projects is by default disabled on most platforms;
          <br> see in <span class="ncbi_dir">internal/c++/{
                <a href="lxr/source/src/internal">src</a>
                |
                <a href="lxr/source/include/internal">include</a>
                }/internal</span> directories
  </li>
</ul>
</dl>


<p>
<a name="ref_ProjectList"></a>
<h4>Finer-grained control of projects: <span class="ncbi_conf_flag">--with-projects</span></h4>

<dl>
    <dt>
    <dd>
If the above options aren't specific enough for you, you can also tell
<span class="ncbi_script">configure</span> which projects you want to build by passing the
flag <span class="ncbi_conf_flag">--with-projects=FILE</span>, where <span class="ncbi_value">FILE</span> contains a
list of
<a href="http://www.ciser.cornell.edu/info/regex.html"><span class="ncbi_term">extended
regular expressions</span></a> indicating which directories to build in.
With this option, the <span class="ncbi_util">make</span> target <span class="ncbi_make_flag">all_p</span> will build
all selected projects under the current directory.  If there is a
project you want to keep track of but not automatically build, you can
follow its name with "&nbsp;update-only". To <em>exclude</em> projects
that would otherwise match, list them explicitly with an initial
hyphen. (Exclusions can also be regular expressions rather than simple
project names.)
<p>
For instance, a file containing the lines 
<pre class="ncbi_code">corelib$
util
serial
-serial/test
test update-only
</pre>
would request a non-recursive build in <span class="ncbi_dir">corelib</span> and a recursive build
in <span class="ncbi_dir">util</span>, and a recursive build in <span class="ncbi_dir">serial</span> that
skipped <span class="ncbi_dir">serial/test</span>.  It would also request keeping the
<span class="ncbi_dir">test</span> project up-to-date (for the benefit of the programs in
<span class="ncbi_dir">util/test</span>).
<p>
<span class="ncbi_note">NOTE:</span> The flags listed <a href="#ref_Optional">above</a> still
apply; for instance, you still need <span class="ncbi_conf_flag">--with-internal</span> to
enable internal projects.  However,
<a href="cvs.html#ref_Update_Projects"><span class="ncbi_script">update_projects.sh</span></a> can
automatically take care of these for you; it will also take any lines
starting with two hyphens as explicit options.
</dl>

<p>
<a name="ref_Misc"></a>
<h4>Miscellaneous: <span class="ncbi_conf_flag">--without-exe, --without-execopy, --with-lib-rebuilds(=ask)</span></h4>

<ul>
  <li> <span class="ncbi_conf_flag">--without-exe</span> --
          do not build the executables enlisted in the <span class="ncbi_make_var">APP_PROJ</span>
  <li> <span class="ncbi_conf_flag">--without-execopy</span> --
          do not copy (yet build) the executables enlisted in the <span class="ncbi_make_var">APP_PROJ</span>
  <li> <span class="ncbi_conf_flag">--with-lib-rebuilds</span> --
          When building an application, attempt to rebuild all of the
          libraries it uses in case they are out of date.
  <li> <span class="ncbi_conf_flag">--with-lib-rebuilds=ask</span> --
          As above, but prompt before any needed rebuilds.  (Do not
          prompt for libraries that are up-to-date.)
</ul>
<dl>
    <dt>
    <dd>

<p>
Here's a more detailed explanation of
<span class="ncbi_conf_flag">--with-lib-rebuilds</span>:  There are three modes of operation.
<ul>
<li> In the default mode (<span class="ncbi_conf_flag">--without-lib-rebuilds</span>),
  starting a build from within a subtree (such as internal) will not
  attempt to build anything outside of that subtree.

<li> In the unconditional mode (<span class="ncbi_conf_flag">--with-lib-rebuilds</span>),
  building an application will make the system rebuild any libraries
  it requires that are older than their sources.  This can be useful
  if you have made a change that affects everything under objects but
  your project only needs a few of those libraries; in that case, you
  can save time by starting the build in your project's directory
  rather than at the top level.

<li> The conditional mode (<span class="ncbi_conf_flag">--with-lib-rebuilds=ask</span>) is like the
  unconditional mode, except that when the system discovers that a
  needed library is out of date, it asks you about it.  You can then
  choose between keeping your current version (because you prefer it
  or because nothing relevant has changed) and building an updated
  version.
</ul>
</dl>


<p>
<a name="ref_Wrappers"></a>
<h4>Compiler-specific <span class="ncbi_script">configure</span> wrappers</h4>

<dl>
    <dt>
    <dd>
Most of the non-GCC compilers require special tools and additional
mandatory flags to compile and link C++ code properly. That's why we
have to have special scripts that perform the required non-standard
compiler-specific pre-initialization for the used
<a href="#ref_ToolsAndFlags">tools and flags</a> before running
<span class="ncbi_script">configure</span>.

<p>
These wrapper scripts are located in the <span class="ncbi_dir">compilers/</span>
directory, and now we have such wrappers for <span class="ncbi_compiler">SUN WorkShop (5.0, 5.1 and 5.2),
MIPSpro 7.3, GCC/Cygwin-NT, KCC</span>, and <span class="ncbi_compiler">MSVC++</span> compilers:
  <ul>
    <li> <span class="ncbi_script">WorkShop.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">WorkShop5.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">WorkShop6.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">WorkShop52.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">MIPSpro73.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">KCC.sh</span> {32|64} [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">ICC.sh</span> [build_dir] [--configure-flags]
    <li> <span class="ncbi_script">gcc_nt.bash</span> [--configure-flags]
    <li> <span class="ncbi_script">msvc_nt.bash</span> [--configure-flags]
  </ul>
Note, that these scripts accept all regular <span class="ncbi_script">configure</span> flags
and then pass them to the <span class="ncbi_script">configure</span> script.
</dl>

<p>
<a name="ref_PreBuiltHeaders"></a>
<h4>Pre-built configuration headers</h4>

<dl>
    <dt>
    <dd>
Although it is possible to run <span class="ncbi_script">configure</span> under Windows NT,
(as we do for the MSVC++ compiler), however it requires having a
<span class="ncbi_util">sh</span>-compatible command interpreter installed on your PC.
In-house, we run <span class="ncbi_script">msvc_nt.bash</span> using
<a href="http://www.lns.cornell.edu/public/COMP/info/bash/bashref_toc.html">
<span class="ncbi_util">bash</span></a> in the
<a href="http://sourceware.cygnus.com/cygwin/">CYGWIN</a>
environment.

<p>
As soon as most of NT users do not usually "play" with the extensions
like <span class="ncbi_util">bash/CYGWIN</span> on their PCs but just want to use MSVC++
Development Studio, so there is a pre-build configuration header
for MSVC++ 6.0:
<span class="ncbi_file">compilers/ncbiconf.ms6</span>.

MSVC++ users can use this header and a ready-to-use hierarchy of
<a href="#ref_MsvcProj">projects for the MS Visual C++ Studio</a>.

<p>
The same is for Mac Metrowerks CodeWarrior on PowerPC --
we have a manually maintained <span class="ncbi_file">compilers/ncbiconf.mac</span>
(however we dont have a ready-to-use Mac-specific project tree).
</dl>

<br>
<hr>

<a name="ref_Reconf"></a>
<h2>Quick reconfiguration <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>


<p>
Sometimes, you change or add configurables (<span class="ncbi_file">*.in</span>
files, such as <span class="ncbi_file">Makefile.in</span> meta-makefiles) in the <span class="ncbi_term">source tree</span>.

<p>
For the <span class="ncbi_term">build tree</span> to pick up these changes,
go to the appropriate build directory and run script <span class="ncbi_script">reconfigure.sh</span>.
It will automagically use just the same command-line arguments that you
used for the original configuration of that <span class="ncbi_term">build tree</span>.

<p>
Run <span class="ncbi_script">reconfigure.sh</span> with argument:
<ul>
        <li> <span class="ncbi_script_a">update</span> --
          if you did not add or remove any <span class="ncbi_term">configurables</span> in the
          <span class="ncbi_term">source tree</span>, but only modified some of them.
        </li>

        <li> <span class="ncbi_script_a">reconf</span> --
          if you changed, added, and/or removed any <span class="ncbi_term">configurables</span> in
        the <span class="ncbi_term">source tree</span>.
        </li>

        <li> <span class="ncbi_script_a">recheck</span> --
          if you also suspect that your working environment (compiler features,
          accessibility of 3rd-party packages, etc.) might have changed since
          your last (re)configuration of the <span class="ncbi_term">build tree</span>, and therefore you
          do not want to use cached check results obtained during the last
          (re)configuration.
        </li>
        <li> <em>without arguments</em> --
             printout script usage info.
        </li>
</ul>

<p>
<span class="ncbi_note">Example:</span>
<pre class="ncbi_cmd">
    cd /home/foobar/c++/GCC-Debug/build
    ./reconfigure.sh reconf
</pre>

Naturally, <span class="ncbi_script_a">update</span> is the fastest of these methods,
<span class="ncbi_make_flag">reconf</span> is slower, and <span class="ncbi_make_flag">recheck</span> (which is an exact equivalent
of re-running <span class="ncbi_script">configure</span> script with the same command-line
arguments as were provided during the original configuration) is the slowest.


<p>
<br>
<hr>

<a name="ref_Example"></a>
<h2>An example of configuration, installation and build <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

To retrieve, configure, install and build all available NCBI C++ projects:

<pre class="ncbi_cmd">
# Retrieve NCBI C++ sources from the NCBI CVS tree
# (e.g. to "cpp_foo/" dir)
cvs checkout -d ~/cpp_foo internal/c++


# Configure for WorkShop 6.0 compilers, then build recursively
cd ~/cpp_foo
compilers/WorkShop6.sh 32 my_build_dir

cd my_build_dir/build
make all_r


# Configure for GCC compiler, then build recursively
cd ~/cpp_foo
./configure

cd GCC-Debug/build
make all_r
</pre>


<hr>

<a name="ref_Compilers"></a>
<h2>List of supported compilers <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
As for now, at least the following compilers give enough support
(as concerns to the C++ and STL implementation) to build NCBI C++
libraries and tools:
<ul>
  <li> <a href="http://gcc.gnu.org/">
       <span class="ncbi_compiler">GCC 3.0.[1,2,3,4]</span></a>
    <ul>
      <li> Linux RedHat 6.2 and higher --- <span class="ncbi_platform">PC-Intel</span> </li>
      <li> Solaris 2.8 and higher --- <span class="ncbi_platform">SUN-Sparc</span> </li>
    </ul>
        </li>

  <li> <a href="http://gcc.gnu.org/">
       <span class="ncbi_compiler">GCC 2.95.[1,2,3]</span></a>
    <ul>
      <li> Solaris 2.7, 2.8 --- <span class="ncbi_platform">SUN-Sparc</span> and <span class="ncbi_platform">PC-Intel</span></li>
      <li> Linux RedHat 5.2 and higher --- <span class="ncbi_platform">PC-Intel</span></li>
      <li> FreeBSD 4.1-RELEASE --- <span class="ncbi_platform">PC-Intel</span></li>
      <li> OSF1 Compaq Tru64 UNIX V5.1 --- <span class="ncbi_platform">DEC-Alpha</span></li>
      <li> IRIX64 6.5 --- <span class="ncbi_platform">SGI-Mips</span></li>
    </ul>
  </li>

  <li> <a href="ftp://ftp.xraylith.wisc.edu/pub/khan/gnu-win32/cygwin/gcc-2.95/">
       <span class="ncbi_compiler">GCC 2.95</span></a>
    <ul>
      <li>
      Windows NT 4.0
      with <a href="http://sourceware.cygnus.com/cygwin/">CYGWIN</a> Beta 20.1 --- <span class="ncbi_platform">PC-Intel</span> <br>
                (<span class="ncbi_note">Note:</span>  has not been built for a long long time)
      </li>
    </ul>
  </li>

  <li> <a href="http://www.sun.com/workshop/visual/">
       <span class="ncbi_compiler">Sun WorkShop 5.1 (Forte 6), 5.2, 5.3 </span></a>
    <ul>
      <li> 32/64-bit: Solaris 2.7, 2.8 --- <span class="ncbi_platform">SUN-Sparc</span> <br>
           (<span class="ncbi_note">Note:</span>  <span class="ncbi_util">ld</span> crashes on huge ~30M static executables in 64-bit Debug mode)</li>
      <li> 32-bit: Solaris 2.7 --- <span class="ncbi_platform">PC-Intel</span> </li>
    </ul>
  </li>

  <li> <u><span class="ncbi_compiler">MSVC++ 6.0 (SP3)</span></u>
    <ul>
      <li> Windows NT 4.0  --- <span class="ncbi_platform">PC-Intel</span> </li>
    </ul>
  </li>

  <li> <u><span class="ncbi_compiler">MIPSpro 7.3.1.1m, 7.3.1.2m</span></u>
    <ul>
      <li> 32-bit (-n32): IRIX64 6.5 --- <span class="ncbi_platform">SGI-Mips</span> </li>
      <li> 64-bit:  IRIX64 6.5 --- <span class="ncbi_platform">SGI-Mips</span> </li>
    </ul>
  </li>

  <li> <u><span class="ncbi_compiler">Metrowerks CodeWarrior</span></u>
    <ul>
      <li> MacOS -- <span class="ncbi_platform">PowerPC</span> </li>
    </ul>
  </li>

  <li> <a href="http://www.kai.com/C_plus_plus/">
       <span class="ncbi_compiler">KAI C++ (KCC) 4.0</span></a>
    <ul>
      <li> Solaris 2.7 and higher --- <span class="ncbi_platform">SUN-Sparc</span> </li>
      <li> Linux RedHat 6.2 --- <span class="ncbi_platform">PC-Intel</span></li>
    </ul>
  </li>

  <li> <a href="http://developer.intel.com/software/products/compilers/c50/linux/">
       <span class="ncbi_compiler">IntelC++ (ICC) 5.0 (beta)</span></a>
    <ul>
      <li> Linux RedHat 6.2 and higher --- <span class="ncbi_platform">PC-Intel</span></li>
    </ul>
  </li>
</ul>

NOTE: Some projects are very platform-specific, and they cannot
be built for all of the supported platforms.
Most of such projects are located under the
<span class="ncbi_dir">internal/c++/{src|include}/internal/</span>
directories.


<p>
<br>
<hr>

<a name="ref_AdHoc"></a>
<h2>Ad-hoc installations <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h2>

<p>
<a name="ref_MsvcProj"></a>
<h3>MS Visual C++ <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h3>

<p>
<a name="ref_MsvcProjDownload"></a>
<h4>Getting the Toolkit sources</h4>

<dl>
    <dt>
    <dd>
Suppose you are going to deploy the NCBI C++ tree to your local PC, in directory
<span class="ncbi_dir">C:\cxx</span>. You can do it one of the following ways:
<ul>
        <li> do <a href="win_cvs.html">CVS checkout</a> of
          <span class="ncbi_dir">internal/c++</span>. This can be done right on your
          PC, if you have installed CVS client there:
          <br> <span class="ncbi_cmd">cvs checkout -d cxx internal/c++</span></li>
			 <br> <span class="ncbi_note">NOTE: in this (and only this case)
			 you will have to manually copy
			 <span class="ncbi_file">cxx\compilers\ncbiconf.ms6</span> to 
			 <span class="ncbi_file">cxx\include\ncbiconf.h</span>;
			 you can also call script
          <span class="ncbi_file">c++/compilers/msvc_nt.bat</span>
			 which does just the same.
		  </span> 
        <li> checkout only the core sources on your UNIX workstation by running (<a href="cvs_core_msvc.html">notes here</a>)
          <br> <span class="ncbi_cmd">$NCBI/c++/scripts/cvs_core.sh cxx --msvc --without-cvs --with-objects</span>
          <br> and then copy the whole resultant directory
          <span class="ncbi_dir">cxx</span> to your PC directory <span class="ncbi_dir">C:\cxx</span></li>
        <li> if you have the Toolkit sources in the publicly distributed
          self-extracting archive, then just expand the archive, and you are ready
          to build any (or all) of MSVC++ project configurations.
          The archive also contains pre-generated ASN classes.</li>
</ul>
</dl>


<p>
<a name="ref_MsvcProjFiles"></a>
<h4>Working with NCBI C++ project files</h4>

<dl>
    <dt>
    <dd>
Project files for NCBI C++ Toolkit are now generated automatically from the template project files,
which are kept in the CVS repository. Click <a href="msvc_prj.html">here</a> to know how this is done, or
if you wish to modify and/or add the NCBI C++ Toolkit project files.
There is a short summary:
<ul>
    <li>All project files in the CVS repository contain a single (<span class="ncbi_dir">DebugDLL</span>) configuration. This way, you can directly use
    <span class="ncbi_util">cvs.exe</span> on your PC and have project files checked out and in, just <a href="#ref_MsvcProjSettings">make
    sure</a> you work with single-configuration project files in <span class="ncbi_dir">DebugDLL</span> mode.</li>
    <li>The checked out project files can be checked in back to the CVS only if they contain exactly one configuration
        (<span class="ncbi_dir">DebugDLL</span>).</li>
    <li>Use script <a href="msvc_prj.html#all2one_sh"><span class="ncbi_script">all2one.sh</span></a> to convert any multi-configuration
    project file to a single configuration one.</li>
    <li>Use script <a href="msvc_prj.html#one2one_sh"><span class="ncbi_script">one2one.sh</span></a> to change configuration in any
    single-configuration project file (e.g. from <span class="ncbi_dir">ReleaseMT</span> to <span class="ncbi_dir">DebugDLL</span>).</li>
    <li>Use script <a href="msvc_prj.html#one2all_sh"><span class="ncbi_script">one2all.sh</span></a> to convert a single configuration
    (template) project file to the multi-configuration one (containing all of the following configurations:
    <span class="ncbi_dir">Debug</span>, <span class="ncbi_dir">DebugMT</span>, <span class="ncbi_dir">DebugDLL</span>, <span class="ncbi_dir">Release</span>, <span class="ncbi_dir">ReleaseMT</span>, <span class="ncbi_dir">ReleaseDLL</span>).</li>
</ul>
</dl>

<p>
<a name="ref_MsvcProjTree"></a>
<h4>Building the whole NCBI C++ tree locally</h4>

<dl>
    <dt>
    <dd>
Now, if you want to use MS Visual C++ IDE to work with these sources, then you have to do exactly the following:
<p>
<ul>
  <li>
  Go to directory <span class="ncbi_dir">compilers</span> and run script <span class="ncbi_script">msvc_nt.bat</span>.
  (You can skip this step if you obtained your sources from the distributed
   self-extracting archive, or by <span class="ncbi_cmd">$NCBI/c++/scripts/cvs_core.sh cxx --msvc .....</span>)
  </li>
  <li>All MSVC++ project files are already adjusted to contain proper information about include file directories
  (using relative paths), thus no additional configuration required (<a href="old_msvc_ide_cnf.html">the old way</a> of
  configuring MSVC++ is deprecated, but still can be used).</li>
</ul>

<p>
After the installation is complete you can build the Toolkit projects in two different ways:
<ul>
    <li>Build the entire Toolkit from command line in batch mode: <span class="ncbi_util">chdir</span> to <span class="ncbi_dir">compilers/msvc_prj</span>, and run batch
    file <a href="msvc_prj.html#all_bat"><span class="ncbi_script">all.bat</span></a> there (provided that <span class="ncbi_util">msdev.exe</span>
    is in your <span class="ncbi_env">PATH</span>).
    When run without arguments, it builds all available configurations of all available projects. Or,
    you can pass any combination of <span class="ncbi_dir">Debug</span>, <span class="ncbi_dir">DebugMT</span>, <span class="ncbi_dir">DebugDLL</span>, <span class="ncbi_dir">Release</span>, <span class="ncbi_dir">ReleaseMT</span>,
    <span class="ncbi_dir">ReleaseDLL</span> as batch file argument(s)
    to build all projects in the specified configurations only.</li>
    <li>Open Microsoft Developer Studio with workspace <span class="ncbi_file">compilers/msvc_prj/ncbi_cpp.dsw</span>, and build the
        following projects:
    <ul>
        <li> <span class="ncbi_proj">all</span> -- everything
        <li> <span class="ncbi_proj">all_core</span> -- all basic libraries and test applications
        <li> <span class="ncbi_proj">all_core_libs</span> -- all basic libraries
        <li> <span class="ncbi_proj">all_objects</span> -- all serialization libraries (as of now,
            providing for the serialization of NCBI ASN.1 objects), and their test applications
        <li> <span class="ncbi_proj">all_objects_libs</span> -- serialization libraries only
        <li> <span class="ncbi_proj">all_gui</span> -- all GUI stuff (libraries plus applications)
        <li> <span class="ncbi_proj">all_gui_libs</span> -- GUI libraries only
        <li> <span class="ncbi_proj">all_tools</span> -- non-graphics tools and their related libraries
        <li> <span class="ncbi_proj">all_tools_libs</span> -- non-graphics libraries only
        <li> any single library and/or application -- other projects in this workspace</li>
    </ul>
        You can build <em>any</em> project in any of Debug and/or Release versions. To switch among Debug or
        Release configurations, use <span class="ncbi_menu">"Build"/"Set active configuration..."</span> menu.
        <br>If the Toolkit tree was extracted by the script <span class="ncbi_script">cvs_core.sh</span> with option <span class="ncbi_conf_flag">--without-objects</span>,
        then the target <span class="ncbi_proj">all</span> is made nearly equivalent to <span class="ncbi_proj">all_core</span> because almost every other project requires
        serialization libraries (<span class="ncbi_lib">objects</span>) to be present.
</ul>
</dl>

<p>
<a name="ref_MsvcProjCXX"></a>
<h4>Using pre-built NCBI C++ Toolkit in your projects</h4>

<dl>
    <dt>
    <dd>
If you don't want to build the whole NCBI C++ tree, but just
need to <em>use</em> the NCBI C++ Toolkit functionality in your own, separate projects,
there are pre-built libraries located at:
<ul>
    <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>ReleaseDLL</em></span> -- linked against dynamic Microsoft run-time library,
    MT-safe versions
    <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>Release</em></span> -- linked against static Microsoft run-time library,
    <emph>not</emph> MT-safe versions
    <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>DebugDLL</em></span> -- linked against dynamic Microsoft run-time library,
    MT-safe versions with debug information preserved
    <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>Debug</em></span> -- linked against static Microsoft run-time library,
    <emph>not</emph> MT-safe versions with debug information preserved
</ul>
along with the header and source files at:
<ul>
  <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>include</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\cxx\<em>src</em></span>
</ul>
There is a "one-blob" Toolkit source directory, <span class="ncbi_dir">\\dizzy\public\cxx\<em>altsrc</em></span>, which is primarily
needed for debugging a program linked against pre-compiled Toolkit libraries.
<p>

The recommended way to refer to the include file directory is to put <span class="ncbi_dir">\\dizzy\public\cxx\<em>include</em></span>
in <span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"C/C++"</span>, category <span class="ncbi_menu">"Preprocessor",
</span>list <span class="ncbi_menu">"Additional include directories"</span>.
<p>
You have to specify the used library name(s) in <span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"Link"</span>,
category <span class="ncbi_menu">"Input"</span>, list <span class="ncbi_menu">"Object/Library modules"</span>.
<br>
You also have to put the correct path to the libraries (either <span class="ncbi_dir">\\dizzy\public\cxx\<em>ReleaseDLL</em></span>,
<span class="ncbi_dir">\\dizzy\public\cxx\<em>DebugDLL</em></span> etc, according to the configuration you are tuning)
in the field <span class="ncbi_menu">"Additional library path"</span>.
<p>
No further configuration is necessary unless you want to trace and/or debug library sources.
Moreover, if one of <a href="msvc_prj.html#scripts">conversion scripts</a> is then applied to your project file, then
the proper links to required versions of the libraries are automatically maintained according to a chosen configuration.
<p>
If, however, you need to trace through the library source code, then you have to put
<span class="ncbi_dir">\\dizzy\public\cxx\<em>src</em></span>, or sometimes <span class="ncbi_dir">\\dizzy\public\cxx\<em>altsrc</em></span> to
<span class="ncbi_menu">"Tools"/"Options..."</span>, tab <span class="ncbi_menu">"Directories"</span>, list <span class="ncbi_menu">"Source files"</span>.
<p>
In either case, don't forget to provide the right <a href="#ref_MsvcProjSettings">settings</a> for your project
to make sure that it is built compatible with the chosen NCBI C++ libraries.
</dl>

<p>
<a name="ref_MsvcProjWxwin"></a>
<h4>Using wxWindows</h4>

<dl>
    <dt>
    <dd>
The pre-built versions of this library (<a href="wxwin_setup.html">modified</a> to suit certain requirements),
along with include files, sources, documentation and project files,
which we provide, are all put to:
<ul>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>Debug</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>DebugMT</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>DebugDLL</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>Release</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>ReleaseMT</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>ReleaseDLL</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>include</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>src</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>docs</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\wxwin\<em>wxwin_prj</em></span>
</ul>
Your project has to specify all the library names (<span class="ncbi_lib">tiff.lib jpeg.lib pnm.lib xpm.lib zlib.lib wx.lib</span>) in <span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"Link"</span>, category <span class="ncbi_menu">"Input"</span>, list <span class="ncbi_menu">"Object/Library modules"</span>.
Please note that although the wxWindows documentation instructs you to use *.lib in Release mode and *d.lib in Debug mode,
we renamed the libraries to have the same names in any configuration, but we keep them in separate directories.
Also note that in both <span class="ncbi_dir">ReleaseDLL</span> and <span class="ncbi_dir">DebugDLL</span> configurations, only one library
<span class="ncbi_lib">wx.lib</span> is required to link your program dynamically with <span class="ncbi_lib">wx.dll</span>. If <a href="msvc_prj.html#scripts">conversion
scripts</a> are later applied to your project file, then the proper set of the libraries is chosen automatically.
<br>
You also have to specify the correct path to the libraries (<span class="ncbi_dir">\\dizzy\public\wxwin\</span><span class="ncbi_dir">[Debug|Release]*</span>),
according to the configuration you are adjusting, in the field <span class="ncbi_menu">"Additional library path"</span>.
<p>
Note that many programs that use wxWindows may require additional system libraries.
The list of known libraries includes (but not limited to) the following:
<span class="ncbi_lib">advapi32.lib</span>, <span class="ncbi_lib">comctl32.lib</span>, <span class="ncbi_lib">comdlg32.lib</span>, <span class="ncbi_lib">gdi32.lib</span>,
<span class="ncbi_lib">ole32.lib</span>, <span class="ncbi_lib">shell32.lib</span>, <span class="ncbi_lib">user32.lib</span>, <span class="ncbi_lib">winmm.lib</span>, <span class="ncbi_lib">wsock32.lib</span>. And if the program
uses OpenGL graphics, the following two libraries definitely come in addition: <span class="ncbi_lib">glu32.lib</span> and
<span class="ncbi_lib">opengl32.lib</span>. All those libraries have to be listed in <span class="ncbi_menu">"Objects/Library modules"</span> of
linker settings (as described earlier for wxWindows libraries).

<p>
We recommend that you put the include file directory <span class="ncbi_dir">\\dizzy\public\wxwin\<em>include</em></span>
in <span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"C/C++"</span>, category <span class="ncbi_menu">"Preprocessor"</span>,
list <span class="ncbi_menu">"Additional include directories"</span>. You have to define all wxWindows-related preprocessor
symbols as required by wxWindows documentation (using <span class="ncbi_menu">"Project"/"Settings..."</span>,  tab <span class="ncbi_menu">"C/C++"</span>,
category <span class="ncbi_menu">"General"</span>, list <span class="ncbi_menu">"Preprocessor definitions"</span>). In particular <span class="ncbi_macro">__WXDEBUG__</span> must be
defined in Debug configurations, and <span class="ncbi_macro">WXUSINGDLL</span> - in DLL configurations.
The <a href="msvc_prj.html#scripts">conversion scripts</a> are aware of these symbols, and they make all necessary adjustments to keep these symbols consistent -- whenever you convert your project file(s).
<p>
No further configuration is necessary unless you want to trace and/or debug library sources.
Moreover, if one of <a href="msvc_prj.html#scripts">conversion scripts</a> is then applied to your project,
the proper links to required versions of the libraries are automatically maintained according to a chosen configuration.
<p>
If, however, you need to trace through the library source code, you have to put <span class="ncbi_dir">\\dizzy\public\wxwin\<em>src</em></span>
to <span class="ncbi_menu">"Tools"/"Options..."</span>, tab <span class="ncbi_menu">"Directories"</span>, list <span class="ncbi_menu">"Source files"</span>.
<p>
You may have a local copy of wxWindows package, which has to be installed in directory
<span class="ncbi_dir">wxwin</span> at exactly the same level where the NCBI C++ Toolkit is installed (that is, their upper level
directories <span class="ncbi_dir">wxwin</span> and <span class="ncbi_dir">cxx</span> should appear in the same parent directory).
When using local copy of the wxWindows for your  projects, you have to specify <span class="ncbi_term">relative</span> paths to include files,
libraries and sources instead of absolute paths, but exactly the same way as described above.
Do not use the "native" (shipped with wxWindows) project files to build the wxWindows libraries - they are not consistent with our projects.
Instead,
<ol>
    <li>Create directory <span class="ncbi_dir">wxwin/wxwin_prj</span> and copy there
       (preserving the file layout) the contents of directory
       <span class="ncbi_dir">wxwin_prj</span>. You can get this directory either
       from <span class="ncbi_dir">\\dizzy\public\wxwin\<em>wxwin_prj</em></span> (NCBI network), or from
       <span class="ncbi_dir">cxx\compilers\<em>wxwin_prj</em></span> (C++ Toolkit).
   </li>
    <li>Make sure that <span class="ncbi_util">msdev.exe</span> is in you <span class="ncbi_env">PATH</span>, then change directory to <span class="ncbi_dir">wxwin/wxwin_prj</span>
    and start batch file <span class="ncbi_script">wxwin.bat</span> there. This script accepts one of the following arguments, <span class="ncbi_script_a">DLL</span>,
    <span class="ncbi_script_a">LIB</span>, or <span class="ncbi_script_a">ALL</span>:</li>
    <ul>
        <li><span class="ncbi_script_a">DLL</span>: build DLL versions of wxWindows libraries, and store them in <span class="ncbi_dir">wxwin/ReleaseDLL</span>
            and <span class="ncbi_dir">wxwin/DebugDLL</span> directories (for <span class="ncbi_dir">ReleaseDLL</span> and <span class="ncbi_dir">DebugDLL</span> configurations
            respectively).</li>
        <li><span class="ncbi_script_a">LIB</span>: build static versions of wxWindows libraries, and store them in directories
            <span class="ncbi_dir">wxwin/Debug</span>, <span class="ncbi_dir">wxwin/DebugMT</span>, <span class="ncbi_dir">wxwin/Release</span>, and <span class="ncbi_dir">wxwin/ReleaseMT</span>.</li>
        <li><span class="ncbi_script_a">ALL</span>: build everything listed above.</li>
        <br>
        Note that with both <span class="ncbi_script_a">DLL</span> and <span class="ncbi_script_a">LIB</span> options you may limit the build to be done only for
        certain configurations by listing the configuration names in the command line after the option.
    </ul>
    That is, the batch file builds libraries in the directories where <em>our</em> project files
    <a href="#refWxwinPaths">expect</a> to locate them when using local copies of the Toolkit libraries.
    <li>To get rid of the intermediate files created during wxWindows compilation and no longer needed,
        you can just remove the entire subtree <span class="ncbi_dir">wxwin/wxwin_prj</span>.
</ol>

<p>
<a name="refWxwinPaths"></a>All <em>our</em> project files (which are provided for the projects
using wxWindows) contain both relative and absolute paths to, correspondingly, both local
(installed by you, as described above) and pre-built (<span class="ncbi_dir">\\DIZZY\public\wxwin</span>) versions of libraries and
include files, in this order, i.e. the local copy (if any) takes precedence.
Moreover, if a project file is being commited to the CVS, and it has been
<a href="msvc_prj.html#commit_sh">detected</a> that the project refers to wxWindows library, then the paths
(both to include files and to libraries) are automatically canonicalized to point to these two locations.

<p>
As always, don't forget to provide the right <a href="#ref_MsvcProjSettings">compiler settings</a> for your project
to make sure that it is built compatible with the chosen libraries.
</dl>


<a name="ref_MsvcProjFltk"></a>
<h4>Using FLTK</h4>
<dl>
    <dt>
    <dd>
<p>
<a href="http://www.fltk.org">FLTK</a> is a portable C++ graphical user interface toolkit for X
(UNIX&reg;), MacOS&reg;, and Microsoft&reg; Windows&reg;, which supports 3D graphics with OpenGL&reg;.
The pre-built libraries of this toolkit (version 1.1.0rc6)  are installed in <span class="ncbi_dir">\\dizzy\public\fltk</span>.
The installation includes:
<ul>
  <li>Sources (<span class="ncbi_dir">\\dizzy\public\fltk\src</span>),</li>
  <li>Include files (<span class="ncbi_dir">\\dizzy\public\fltk\include</span>),</li>
  <li>Documentation (<span class="ncbi_dir">\\dizzy\public\fltk\documentation</span>),</li>
  <li>Samples (<span class="ncbi_dir">\\dizzy\public\fltk\test</span>),</li>
  <li>Project files for Microsoft Visual C++ v.6.0 (<span class="ncbi_dir">\\dizzy\public\fltk\visualc</span>).</li>
</ul>
There are few changes in the build procedure as compared to the "standard" (recommended by authors) one:
<ul>
  <li>Libraries built in debug mode do not have "d" suffix - they are placed in different directories instead,</li>
  <li>Static libraries are built using <span class="ncbi_term">Single-Threaded</span> or <span class="ncbi_term">Multithreaded</span> run-time libraries
  (instead of <span class="ncbi_term">Multithreaded DLL</span> ones).
  The only library which requires <span class="ncbi_term">Multithreaded DLL</span> run-time libraries is the DLL version of
  FLTK - <span class="ncbi_lib">fltkdll</span>.</li>
</ul>
</p>
    </dd>
    </dt>
</dl>

<p>
<a name="ref_MsvcProjC"></a>
<h4>Using NCBI C Toolkit</h4>

<dl>
    <dt>
    <dd>
There are projects (such as <span class="ncbi_proj">ctools</span>, <span class="ncbi_proj">xasn</span> etc) that engage the
<a href="http://sunweb.ncbi.nlm.nih.gov:6224/IEB/ncbi_toolbox/README.htm">NCBI C Toolkit</a>.
To build these, you have to have the NCBI C Toolkit libraries and
header files accessible from your PC, and you must specify path to them:
<ol>
<li>For libraries:</li>
<br><span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"Link"</span>, category <span class="ncbi_menu">"Input"</span>, fields <span class="ncbi_menu">"Object/Library modules"</span> and
<span class="ncbi_menu">"Additional library path"</span>.
<li>For include files:</li>
<br><span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"C/C++"</span>, category <span class="ncbi_menu">"Preprocessor"</span>,
list <span class="ncbi_menu">"Additional include directories"</span>.
</ol>
For example, here are the paths to the automatically built C Toolkit:
<ul>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>include</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>altsrc</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>ReleaseDLL</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>Release</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>DebugDLL</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>Debug</em></span>
  <li> <span class="ncbi_dir">\\dizzy\public\ncbi\<em>src</em></span>
</ul>

For backward compatibility we maintain copies of production MT-safe libraries (<span class="ncbi_dir">ReleaseDLL</span>) in <span class="ncbi_dir">\\dizzy\public\<em>lib</em></span>,
and copies of MT-safe debug libraries (<span class="ncbi_dir">DebugDLL</span>) in <span class="ncbi_dir">\\dizzy\public\<em>dbglib</em></span>. The use of there
"historically kept" directories is deprecated, and all new projects have to refer to the new names from the list
above precisely the same way, as explained earlier in <a href="#ref_MsvcProjCXX">"How to use pre-built NCBI C++ libraries"</a>.
For convenience and uniformity, a copy of the source code directory (<span class="ncbi_dir">altsrc</span>) is now maintained in
<span class="ncbi_dir">\\dizzy\public\<em>src</em></span>.
<p>
As in case with <a href="#refWxwinPaths">wxWindows</a> library, if the project that we provide
is using the NCBI C Toolkit, then the include files and libraries are referred by means of both
relative and absolute paths. If you are going to use your local copy of the NCBI C Toolkit, then
place it in directory <span class="ncbi_dir">ncbi</span>, which must reside in the same directory, where the C++ Toolkit does
(i.e. <span class="ncbi_dir">ncbi</span> and <span class="ncbi_dir">cxx</span> subdirectories must appear in the same parent directory). Then, you have to copy the C Toolkit
libraries to one of <span class="ncbi_dir">ncbi/ReleaseMT</span>, <span class="ncbi_dir">ncbi/DebugMT</span> etc subdirectories (according to the configuration used).
Again, if a project file is being commited to the CVS and found to use the NCBI C Toolkit (either
locally, or via <span class="ncbi_dir">\\DIZZY\</span>), then the project <a href="msvc_prj.html#commit_sh">automatically</a> gets
both paths (relative and absolute) for both include files and libraries.
<p>
Please refer to the following section for mandatory project settings.
</dl>

<p>
<a name="ref_MsvcProjSettings"></a>
<h4>Mandatory project settings (RTTI, MT-safety)</h4>

<dl>
    <dt>
    <dd>
When you compose your own, out-of-the-tree projects, which use pre-built C/C++ Toolkit or wxWindows
libraries (which are built in <em>MT-safe</em> mode, with <span class="ncbi_make_flag">/MT</span> flag),
you have to make sure that your projects are built in MT-safe mode as well.
<br>In addition, many C++ projects use <span class="ncbi_term">Run-Time Type Info</span>.
<br>To meet these requirements, you must do the following in <span class="ncbi_menu">"Project"/"Settings..."</span>, tab <span class="ncbi_menu">"C/C++"</span>:
<ul>
  <li> Category <span class="ncbi_menu">"C++ Language"</span>: Enable RTTI
  <li> Category <span class="ncbi_menu">"Code generation"</span>:  Use run-time library:
    <ul>
      <li> <span class="ncbi_menu">"Multithreaded"</span> for the ReleaseMT configuration
      <li> <span class="ncbi_menu">"Debug Multithreaded"</span> for the DebugMT configuration
    </ul>
</ul>
</dl>

<p>
<hr>

<a name="ref_Mac"></a>
<h3>Macintosh <font size=-2><span class=nava>[<a href="#ref_ConfigTop">TOP</a>]</span></font></h3>

<p>
<a name="ref_MacProjDownload"></a>
<h4>Getting the Toolkit sources</h4>

<dl>
    <dt>
    <dd>
Suppose you need to deploy the NCBI C++ tree to your local Mac, in directory
<span class="ncbi_dir">cxx</span>. You can do it one of the following ways:
<ul>
  <li> do <a href="mac_cvs.html">CVS checkout</a> of
       <span class="ncbi_dir">internal/c++</span>. This can be done right on your
       Mac, if you have installed CVS client there:
       <br> <span class="ncbi_cmd">cvs checkout -d cxx internal/c++</span></li>
  <li> checkout only the core sources on your UNIX workstation by running
       <br> <span class="ncbi_cmd">$NCBI/c++/scripts/cvs_core.sh cxx --mac --without-cvs --with-objects</span>
       <br> and then copy the whole resultant directory
       <span class="ncbi_dir">cxx</span> to your local Mac directory <span class="ncbi_dir">cxx</span></li>
  <li> if you have the Toolkit sources in the publicly distributed
       self-extracting archive, then just expand the archive, and you are
       ready to build any (or all) of the Mac project configurations.
       The archive also contains pre-generated ASN classes.</li>
</ul>
</dl>

<p>
<a name="ref_MacProjTree"></a>
<h4>Building the whole NCBI C++ tree locally</h4>

<dl>
    <dt>
    <dd>
The directions are <a href="config_mac.html">here</a>.
</dl>


<br>

<!--#include virtual="./ssi/navlinks.shtml" -->

<table border=0 width="100%" cellspacing=0>
<script>
<!--
print_author('cpp-core', 'Denis Vakatov', '$Date$', 'ncbi.nlm.nih.gov');
print_author('cpp-core', 'Anton Lavrentiev');
//-->
</script>
</table>

<!--#include virtual="./ssi/footer.shtml" -->
